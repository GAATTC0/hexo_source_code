window.__require=function e(t,o,n){function r(a,s){if(!o[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var p=o[a]={exports:{}};t[a][0].call(p.exports,function(e){return r(t[a][1][e]||e)},p,p.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AStar:[function(e,t,o){"use strict";cc._RF.push(t,"d2d9fjlktNNQ5Q0MtvyeWSS","AStar"),Object.defineProperty(o,"__esModule",{value:!0}),o.AStar=void 0;var n=function(){function e(){this.bool_Slant=!1,this.mapArr=[],this.mapLen=100,this.mapSlantLen=140}return e.prototype.initMap=function(e,t,o){this.mapArr=[],this.mapLen=o,this.mapSlantLen=Math.round(this.mapLen/.7);for(var n=0;n<e;n++){for(var i=[],a=0;a<t;a++)i.push(r.pass);this.mapArr.push(i)}},e.prototype.setMapObs=function(e,t,o){void 0===o&&(o=1),this.isOutMap(e,t)||(this.mapArr[e][t]=o)},e.prototype.getAstar=function(e,t){var o=new i;o.startPoint=e,o.endPoint=t;var n=this.newNode(r.pass,e,null,0,this.getH(e,t));for(o.openList.push(n);;){var a=o.getMinNode();o.closeList.push(a),o.openList.splice(o.openList.indexOf(a),1),this.searchRound(a,0,1,o),this.searchRound(a,0,-1,o),this.searchRound(a,-1,0,o),this.searchRound(a,1,0,o),this.bool_Slant&&(this.searchRound(a,1,1,o),this.searchRound(a,1,-1,o),this.searchRound(a,-1,1,o),this.searchRound(a,-1,-1,o));var s=o.endPointInCloseList();if(s)return o.getPathList(s);if(0==o.openList.length)return null}},e.prototype.searchRound=function(e,t,o,n){var i={x:e.point.x+t,y:e.point.y+o};if(this.isOutMap(i.x,i.y))return null;if(this.mapArr[i.x][i.y]!==r.pass)return null;if(null!=n.isInCloseList(i))return null;var a=this.mapLen;0!=t&&0!=o&&this.bool_Slant&&(a=this.mapSlantLen);var s=n.getNodeForOpenList(i);if(null==s)return s=this.newNode(r.pass,i,e,e.g+a,this.getH(i,n.endPoint)),n.openList.push(s),null;e.g+a<s.g&&(s.g=e.g+a,s.parent=e)},e.prototype.getH=function(e,t){return(Math.abs(t.x-e.x)+Math.abs(t.y-e.y))*this.mapLen},e.prototype.newNode=function(e,t,o,n,r){return{point:t,parent:o,tag:e,g:n,h:r}},e.prototype.isOutMap=function(e,t){return e<0||t<0||e>this.mapArr.length-1||t>this.mapArr[0].length-1},e}();o.AStar=n;var r,i=function(){function e(){this.openList=[],this.closeList=[]}return e.prototype.getNodeForOpenList=function(e){for(var t=0;t<this.openList.length;t++)if(this.eqPoint(e,this.openList[t].point))return this.openList[t];return null},e.prototype.getMinNode=function(){for(var e=this.openList[0],t=0;t<this.openList.length;t++){var o=this.openList[t];o.g+o.h<e.g+e.h&&(e=o)}return e},e.prototype.endPointInCloseList=function(){for(var e=0;e<this.closeList.length;e++){var t=this.closeList[e];if(this.eqPoint(t.point,this.endPoint))return t}return null},e.prototype.isInCloseList=function(e){for(var t=0;t<this.closeList.length;t++){var o=this.closeList[t];if(this.eqPoint(o.point,e))return o}return null},e.prototype.eqPoint=function(e,t){return e.x==t.x&&e.y==t.y},e.prototype.getPathList=function(e){for(var t=e,o=[];;){if(!t.parent)return o.reverse();o.push(t.point),t=t.parent}},e}();(function(e){e[e.pass=0]="pass",e[e.obs=1]="obs"})(r||(r={})),cc._RF.pop()},{}],ActionTools:[function(e,t,o){"use strict";cc._RF.push(t,"b2c25CPD7ZMCZD/CIj7ZzqP","ActionTools"),Object.defineProperty(o,"__esModule",{value:!0}),o.ActionTools=void 0;var n=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.doLabStrAni=function(e,t,o){e.node.stopAllActions(),e.string="";var n=t.split(""),r=0,i=o/n.length;e.node.runAction(cc.sequence(cc.callFunc(function(){e.string=e.string+n[r],r++}),cc.delayTime(i)).repeat(n.length))},e.prototype.openUIAni=function(e,t,o,n){void 0===o&&(o=.3),void 0===n&&(n=function(){}),e.opacity=0,t.scale=0,e.runAction(cc.fadeTo(o,100)),t.runAction(cc.sequence(cc.scaleTo(o,1).easing(cc.easeBackOut()),cc.callFunc(n)))},e.prototype.closeUIAni=function(e,t,o,n){void 0===o&&(o=.2),void 0===n&&(n=function(){}),e.runAction(cc.fadeOut(o)),t.runAction(cc.sequence(cc.scaleTo(o,0).easing(cc.easeBackIn()),cc.callFunc(n),cc.removeSelf(!0)))},e.prototype.sortFadeToArr=function(e,t,o,n){void 0===t&&(t=.3),void 0===o&&(o=.02),void 0===n&&(n=!1);for(var r=n?0:255,i=0;i<e.length;i++){var a=e[i];a.opacity=0,a.runAction(cc.sequence(cc.delayTime(o*i),cc.fadeTo(t,r)))}},e.prototype.jumpByDegressAni=function(e,t,o,n,r,i){void 0===o&&(o=0),void 0===i&&(i=0);var a=cc.misc.degreesToRadians(t),s=cc.v2(Math.cos(a)*n,Math.sin(a)*n),c=n/r;e.runAction(cc.sequence(cc.delayTime(i),cc.jumpBy(c,cc.v2(1.5*s.x,o),n,1),cc.removeSelf(!0)))},e.prototype.moveDegressAni=function(e,t,o,n,r,i){void 0===o&&(o=200),void 0===r&&(r=!1),void 0===i&&(i=!1),t=t||this.returnRanNum(-180,180);var a=cc.misc.degreesToRadians(t),s=cc.v2(Math.cos(a)*o,Math.sin(a)*o),c=o/n,l=r?0:e.scale,p=i?0:e.opacity;return e.runAction(cc.sequence(cc.spawn(cc.scaleTo(c+.1,l),cc.moveBy(c,s).easing(cc.easeQuadraticActionOut()),cc.fadeTo(c+.1,p)),cc.fadeOut(.1))),c},e.prototype.moveByOutInit=function(e,t,o,n){void 0===t&&(t=.5),void 0===o&&(o=0),void 0===n&&(n=0),e.x+=o,e.y+=n,e.runAction(cc.moveBy(t,cc.v2(-o,-n)).easing(cc.easeBackOut()))},e.prototype.sprRedAni=function(e,t,o,n){var r=0;e.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(e){e.color=cc.Color.RED}),cc.delayTime(t),cc.callFunc(function(e){e.color=cc.Color.WHITE,++r>=o&&null!=n&&n()})).repeat(o))},e.prototype.shakeAni=function(e,t,o,n,r){void 0===t&&(t=!1),void 0===o&&(o=10),void 0===n&&(n=.1),void 0===r&&(r=2);var i=cc.sequence(cc.rotateBy(n,o),cc.rotateBy(n,-o),cc.rotateBy(n,-o),cc.rotateBy(n,o),cc.rotateBy(n,o),cc.rotateBy(n,-o),cc.delayTime(r));t?e.runAction(i.repeatForever()):e.runAction(i)},e.prototype.returnRanNum=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},e._instance=new e,e}();o.ActionTools=n,cc._RF.pop()},{}],AdManager_H5:[function(e,t,o){"use strict";cc._RF.push(t,"a2d4apyHgxPzpAgAaWifHNK","AdManager_H5"),Object.defineProperty(o,"__esModule",{value:!0}),o.AdManager_H5=void 0;var n=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.showIntersAd=function(){adBreak({type:"next",name:"restart-game"})},e.prototype.showVideoAd=function(e,t){var o=this;this.videoBack=null,this.errorBack=null,e&&(this.videoBack=e),t&&(this.errorBack=t),adBreak({type:"reward",name:"dasdf",beforeReward:function(e){e()},adDismissed:function(){o.errorVideo()},adViewed:function(){o.finishVideo()},adBreakDone:function(){o.finishVideo()}})},e.prototype.finishVideo=function(){this.videoBack&&this.videoBack(),this.videoBack=null,this.errorBack=null},e.prototype.errorVideo=function(){this.errorBack&&this.errorBack(),this.videoBack=null,this.errorBack=null},e._instance=new e,e}();o.AdManager_H5=n,cc._RF.pop()},{}],AdManager:[function(e,t,o){"use strict";cc._RF.push(t,"2a99aiMR2pMnpcfHJUcJzI4","AdManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.AdManager=void 0;var n=e("../manager/PlatformManager"),r=e("./AdManager_H5"),i=function(){function e(){}return e.initAds=function(){},e.loadAds=function(){},e.showIntersAd=function(){var e=n.PlatformManager.releaseType;e!=n.releaseType.test_TEST&&(e!=n.releaseType.h5_weiSan&&e!=n.releaseType.h5_common||r.AdManager_H5._ins.showIntersAd())},e.showVideoAd=function(e,t){var o=n.PlatformManager.releaseType;o!=n.releaseType.test_TEST?o!=n.releaseType.h5_weiSan&&o!=n.releaseType.h5_common||r.AdManager_H5._ins.showVideoAd(e,t):e&&e()},e}();o.AdManager=i,cc._RF.pop()},{"../manager/PlatformManager":"PlatformManager","./AdManager_H5":"AdManager_H5"}],ArmItem:[function(e,t,o){"use strict";cc._RF.push(t,"777b1Rhi3ZKoo/T3y3z15WW","ArmItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../model/OtherModel"),s=e("../../common/Tools"),c=e("../../ctrl/GameCtrl"),l=e("../../manager/PoolManager"),p=e("../../model/GameModel"),d=e("./Bullet"),u=e("./Player"),h=e("../../common/AudioTools"),m=cc._decorator,f=m.ccclass,g=m.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starNode=null,t.shootSpeed=.1,t.shootPower=1,t.shootNum=1,t.shootRepel=0,t.armConfig=null,t.shoot_Bool=!1,t.shoot_Node=null,t.rotateSpeed=800,t.selfArm_Bool=!1,t.tempShoot=0,t.audioScale=1,t.armAudio=null,t}return r(t,e),t.prototype.onLoad=function(){this.starNode.active=!1},t.prototype.setArmData=function(e,t){this.selfArm_Bool=t,this.shootSpeed=e.shootSpeed,this.shootNum=e.shootNum,this.shootPower=e.shootPower,this.shootRepel=e.repel,this.node.parent.getComponent(u.default).shootRange=e.shootRange,t&&this.node.parent.getComponent(u.default).showRange(!0),this.armConfig=e,this.armAudio=this.node.parent.getComponent(u.default).armAudio,this.audioScale=this.node.parent.getComponent(u.default).audioScale,this.stopFire()},t.prototype.attackPlayer=function(e){var t=this;this.shoot_Node=e,e||this.scheduleOnce(function(){t.stopFire()},.3)},t.prototype.update=function(e){this.armAudio=this.node.parent.getComponent(u.default).armAudio,this.audioScale=this.node.parent.getComponent(u.default).audioScale,null!==this.armAudio&&cc.audioEngine.setVolume(this.armAudio,.4*this.audioScale),this.node.parent.getComponent(u.default).isDeath?this.stopFire():this.shoot_Node&&(this.updateRotate(e),this.updateShoot(e))},t.prototype.updateRotate=function(e){var t=s.Tools.getToNodePosForNode(this.shoot_Node,this.node.parent),o=s.Tools.getAngleForPos(cc.v2(this.node.x,this.node.y),cc.v2(t.x,t.y))-180;this.node.angle=c.GameCtrl._ins.getAngleRotate(this.node.angle,o,this.rotateSpeed*e)},t.prototype.updateShoot=function(e){this.tempShoot+=e,this.tempShoot>=this.shootSpeed&&(this.tempShoot=0,this.fireAudio(),this.sideShoot(this.shootNum))},t.prototype.sideShoot=function(e){void 0===e&&(e=1);for(var t=p.GameModel._ins.mainGame.bulletPool,o=-20*(e-1.5),n=0;n<e;n++){var r=cc.v2(this.starNode.x,this.starNode.y+o*n),i=this.starNode.parent.convertToWorldSpaceAR(r),a=s.Tools.getToNodePosForWorld(cc.v2(i.x,i.y),t);this.shootBullet(cc.v3(a.x,a.y),t)}},t.prototype.shootBullet=function(e,t){var o=l.PoolManager.getPoolObj("bulletPre");return o.parent=t,o.position=e,o.angle=this.node.angle+90,this.selfArm_Bool?o.getComponent(cc.BoxCollider).tag=a.interTag.playerBullet:o.getComponent(cc.BoxCollider).tag=a.interTag.enemyBullet,o.getComponent(d.default).playerNode=this.node.parent,o.getComponent(d.default).powerNum=this.shootPower,this.fireStared(),o},t.prototype.fireStared=function(){var e=this;this.starNode.active=!0,this.starNode.stopAllActions(),this.starNode.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){e.starNode.active=!1})))},t.prototype.fireAudio=function(){c.GameCtrl._ins.gameState==c.GameState.Start?this.armConfig.id>=4?null===this.armAudio&&(this.node.parent.getComponent(u.default).armAudio=h.AudioTools._ins.playAudio("machineGun",.4*this.audioScale,!0)):(this.stopFire(),3==this.armConfig.id?h.AudioTools._ins.playAudio("sinpeGun",.3*this.audioScale):h.AudioTools._ins.playAudio("gunAudio",.1*this.audioScale)):this.stopFire()},t.prototype.stopFire=function(){null!==this.armAudio&&(h.AudioTools._ins.stopAudio(this.armAudio),this.node.parent.getComponent(u.default).armAudio=null,this.armAudio=null)},t.prototype.onDestroy=function(){this.stopFire()},i([g(cc.Node)],t.prototype,"starNode",void 0),i([f],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../common/AudioTools":"AudioTools","../../common/Tools":"Tools","../../ctrl/GameCtrl":"GameCtrl","../../manager/PoolManager":"PoolManager","../../model/GameModel":"GameModel","../../model/OtherModel":"OtherModel","./Bullet":"Bullet","./Player":"Player"}],AudioTools:[function(e,t,o){"use strict";cc._RF.push(t,"bc1bcPG03RIK4fB+zDwX088","AudioTools"),Object.defineProperty(o,"__esModule",{value:!0}),o.AudioTools=void 0;var n=e("./LoadTools"),r=e("./Tools"),i=function(){function e(){this.isPlayAudio=!0,this.isPlayBG=!0,this.armAudio=null}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.playBG=function(e,t){var o=this;void 0===t&&(t=.5),this.isPlayBG&&(this.stopBG(),null!=r.Tools.AudioClipDic.get(e)?this.bgAudio=cc.audioEngine.play(r.Tools.AudioClipDic.get(e),!0,t):n.LoadTools._ins.loadResAny(cc.url.raw("resources/music/"+e+".mp3"),cc.AudioClip,function(e){o.bgAudio=cc.audioEngine.play(e,!0,t)}))},e.prototype.stopBG=function(){this.stopAudio(this.bgAudio)},e.prototype.playAudio=function(e,t,o){if(void 0===t&&(t=.5),void 0===o&&(o=!1),this.isPlayAudio)return null!=r.Tools.AudioClipDic.get(e)?cc.audioEngine.play(r.Tools.AudioClipDic.get(e),o,t):void n.LoadTools._ins.loadResAny(cc.url.raw("resources/music/"+e+".mp3"),cc.AudioClip,function(e){cc.audioEngine.play(e,!0,t)})},e.prototype.stopAudio=function(e){cc.audioEngine.stop(e),e=null},e.prototype.playAudioSource=function(e,t,o){var i=this;if(void 0===t&&(t=.5),void 0===o&&(o=!1),this.isPlayAudio)return null!=r.Tools.AudioClipDic.get(e)?this.newAduioSource(r.Tools.AudioClipDic.get(e),t,o):void n.LoadTools._ins.loadResAny(e,cc.AudioClip,function(e){i.newAduioSource(e,t,o)})},e.prototype.newAduioSource=function(e,t,o){void 0===t&&(t=.5),void 0===o&&(o=!1);var n=new cc.Node,r=n.addComponent(cc.AudioSource);return r.clip=e,r.loop=o,r.volume=t,r.play(),0==o&&cc.tween(n).delay(r.getDuration()+.1).removeSelf().union().start(),r},e._instance=new e,e}();o.AudioTools=i,cc._RF.pop()},{"./LoadTools":"LoadTools","./Tools":"Tools"}],Boss:[function(e,t,o){"use strict";cc._RF.push(t,"e5461OJzOlMTbD1xZa+B60A","Boss");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/Tools"),s=e("../../ctrl/GameCtrl"),c=e("../../manager/EventManager"),l=e("../../model/GameModel"),p=e("../../model/OtherModel"),d=e("../floorItem"),u=e("./ArmItem"),h=e("./Enemy"),m=cc._decorator,f=m.ccclass,g=(m.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onLoad=function(){this.addInitListener(),this.helmetNode.active=!1,this.clothesNode.active=!1,this.roleSkeleton=this.roleNode.getComponent(sp.Skeleton),this.fireStar=this.firearmNode.getChildByName("fireStar")},t.prototype.start=function(){var e=this;this.attackNode=l.GameModel._ins.mainGame.playerTs.node,this.initRoleData(5,1),this.scheduleOnce(function(){e.isMove=!0},.5)},t.prototype.initRoleData=function(e,t){this.switchArm(e),this.switchRoleSkin(t),this.hp_max=500,this.hp_num=this.hp_max},t.prototype.switchArm=function(e){void 0===e&&(e=1),this.armID=e;var t=s.GameCtrl._ins.getArmConfigForID(e),o="Player"==this.node.name;this.firearmNode.getComponent(u.default).setArmData(t,o),this.node.getComponent(cc.CircleCollider).radius=this.shootRange,this.fireStar=this.firearmNode.getChildByName("fireStar"),this.node.getChildByName("firearmNode2").getComponent(u.default).setArmData(t,o)},t.prototype.update=function(e){this.updateAudio(),this.isDeath||(this.updateAIMove(e),this.updateMoveTime(e),this.updateMove(e),this.updateAttack(),this.updateSlider())},t.prototype.updateAttack=function(){var e=this.getAttackArr(),t=this.node.getChildByName("firearmNode2");if(e.length<=0)if(this.attackObsArr.length>0){var o=this.getAttackNode(this.attackObsArr);this.firearmNode.getComponent(u.default).attackPlayer(o.parent),t.getComponent(u.default).attackPlayer(o.parent)}else this.firearmNode.getComponent(u.default).attackPlayer(null),t.getComponent(u.default).attackPlayer(null);else{if(s.GameCtrl._ins.gameState==s.GameState.Start&&e.indexOf(l.GameModel._ins.mainGame.playerTs.node)>=0){var n=l.GameModel._ins.mainGame.playerTs.node;return this.firearmNode.getComponent(u.default).attackPlayer(n),void t.getComponent(u.default).attackPlayer(n)}var r=this.getAttackNode(this.attackPlayerArr);this.firearmNode.getComponent(u.default).attackPlayer(r),t.getComponent(u.default).attackPlayer(r)}},t.prototype.updateAIMove=function(e){if(this.attackPlayerArr.length>0&&(s.GameCtrl._ins.gameState==s.GameState.Start&&this.attackPlayerArr.indexOf(l.GameModel._ins.mainGame.playerTs.node)>=0||s.GameCtrl._ins.gameState!=s.GameState.Start))return this.movePointArr=null,void this.updateRandomToPos(e);this.moveToPos||this.moveToPlayer()},t.prototype.onCollisionEnter=function(e,t){if(t.tag==p.interTag.enemyRange&&e.node!=this.node&&(e.tag==p.interTag.playerBody&&a.Tools.addArrNoValue(this.attackPlayerArr,e.node),e.tag==p.interTag.obs)){var o=e.node.parent.getComponent(d.default).obsType;o!=p.enumObsType.water&&o!=p.enumObsType.obs&&a.Tools.addArrNoValue(this.attackObsArr,e.node)}t.tag==p.interTag.enemyBody&&e.tag==p.interTag.grass&&(this.grassNode=e.node)},t.prototype.onCollisionExit=function(e,t){t.tag==p.interTag.enemyRange&&e.node!=this.node&&(e.tag==p.interTag.playerBody&&a.Tools.removeArrForValue(this.attackPlayerArr,e.node),e.tag==p.interTag.obs&&a.Tools.removeArrForValue(this.attackObsArr,e.node)),t.tag==p.interTag.enemyBody&&e.tag==p.interTag.grass&&(this.grassNode=null)},t.prototype.addInitListener=function(){c.EventManager.addListener(c.EventData.REMOVE_ENEMY,this.removeEnemyBack.bind(this),this.node),c.EventManager.addListener(c.EventData.REMOVE_POP,this.removeEnemyBack.bind(this),this.node)},t.prototype.onDestroy=function(){c.EventManager.removeListenerForTarget(this.node)},i([f],t)}(h.default));o.default=g,cc._RF.pop()},{"../../common/Tools":"Tools","../../ctrl/GameCtrl":"GameCtrl","../../manager/EventManager":"EventManager","../../model/GameModel":"GameModel","../../model/OtherModel":"OtherModel","../floorItem":"floorItem","./ArmItem":"ArmItem","./Enemy":"Enemy"}],Bullet:[function(e,t,o){"use strict";cc._RF.push(t,"e92e1av6XtOVrJvNe96pTfd","Bullet");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/ActionTools"),s=e("../../common/Tools"),c=e("../../manager/PoolManager"),l=e("../../model/GameModel"),p=e("../../model/OtherModel"),d=e("../floorItem"),u=e("./Enemy"),h=e("./Player"),m=cc._decorator,f=m.ccclass,g=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveSpeed=1500,t.powerNum=1,t.playerNode=null,t}return r(t,e),t.prototype.update=function(e){var t=cc.misc.degreesToRadians(-this.node.angle),o=Math.sin(t)*this.moveSpeed*e,n=Math.cos(t)*this.moveSpeed*e;this.node.position=cc.v3(this.node.x+o,this.node.y+n)},t.prototype.removeBullet=function(e){void 0===e&&(e=!1),e&&this.removeParAni(),c.PoolManager.addPoolObj(this.node)},t.prototype.removeParAni=function(){for(var e=s.Tools.random(1,5),t=0;t<e;t++){var o=c.PoolManager.getPoolObj("bulletPar");s.Tools.setSpriteFrame(o,"bulletPar_"+s.Tools.random(1,2)),l.GameModel._ins.mainGame.bulletPool.addChild(o,2);var n=s.Tools.random(150,250);o.opacity=255,o.scale=2,o.stopAllActions(),o.position=this.node.position,o.x+=s.Tools.random(-15,15),o.y+=s.Tools.random(-15,15),o.angle=s.Tools.random(0,360);var r=a.ActionTools._ins.moveDegressAni(o,o.angle+90,n,500,!1,!0);o.runAction(cc.sequence(cc.delayTime(r+.1),cc.callFunc(function(e){c.PoolManager.addPoolObj(e,"bulletPar")},this)))}},t.prototype.onCollisionEnter=function(e,t){e.node!=this.playerNode&&(e.tag==p.interTag.enemyBody?(this.removeBullet(!0),e.node.getComponent(u.default).unAttack(this.powerNum,t.tag,this.playerNode)):e.tag==p.interTag.playerBody?(this.removeBullet(!0),e.node.getComponent(h.default).unAttack(this.powerNum,t.tag,this.playerNode)):e.tag==p.interTag.obs?(this.removeBullet(!0),e.node.parent.getComponent(d.default).unAttackObs(this.powerNum,t.tag)):e.tag==p.interTag.wall&&this.removeBullet())},i([f],t)}(cc.Component));o.default=g,cc._RF.pop()},{"../../common/ActionTools":"ActionTools","../../common/Tools":"Tools","../../manager/PoolManager":"PoolManager","../../model/GameModel":"GameModel","../../model/OtherModel":"OtherModel","../floorItem":"floorItem","./Enemy":"Enemy","./Player":"Player"}],CameraItem:[function(e,t,o){"use strict";cc._RF.push(t,"da8f0R4PoRMyrxAt06qPXBf","CameraItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.zoomTween=null,t.moveTween=null,t}return r(t,e),t.prototype.zoomTatioTween=function(e,t,o,n){var r=this;void 0===n&&(n=0),this.zoomTween&&this.zoomTween.stop(),this.zoomTween=cc.tween(this.node.getComponent(cc.Camera)).delay(n).to(e,{zoomRatio:t}).call(function(){o&&o(),r.zoomTween=null}).start()},t.prototype.moveToAni=function(e,t,o,n){var r=this;void 0===n&&(n=0),this.moveTween&&this.moveTween.stop(),cc.tween(this.node).delay(n).to(t,{position:e},{easing:"sineInOut"}).call(function(){o&&o(),r.moveTween=null}).start()},i([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],Enemy:[function(e,t,o){"use strict";cc._RF.push(t,"aeb36yna2xGGKH3ZAVswMvM","Enemy");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a,s=e("../../common/Tools"),c=e("../../ctrl/GameCtrl"),l=e("../../ctrl/MapCtrl"),p=e("../../manager/EventManager"),d=e("../../model/GameModel"),u=e("../../model/OtherModel"),h=e("../floorItem"),m=e("../popItem"),f=e("./ArmItem"),g=e("./Player"),y=cc._decorator,v=y.ccclass,_=(y.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attackNode=null,t.moveToPos=null,t.moveSpeed=500,t.moveState=0,t.bool_inPosion=!1,t.lastPos=null,t.moveTime=0,t.defaultTime=0,t.movePointArr=[],t.tempRandomT=10,t}return r(t,e),t.prototype.onLoad=function(){this.addInitListener(),this.helmetNode.active=!1,this.clothesNode.active=!1,this.roleSkeleton=this.roleNode.getComponent(sp.Skeleton),this.fireStar=this.firearmNode.getChildByName("fireStar")},t.prototype.start=function(){var e=this;this.attackNode=d.GameModel._ins.mainGame.playerTs.node;var t=s.Tools.random(1,2);this.hp_max=100,this.moveSpeed=400,this.initRoleData(1,t),this.scheduleOnce(function(){e.isMove=!0},Math.random()+.5)},t.prototype.update=function(e){this.updateAudio(),this.isDeath||(this.updateAIMove(e),this.updateMoveTime(e),this.updateMove(e),this.updateAttack(),this.updateSlider())},t.prototype.updateAudio=function(){if(d.GameModel._ins.mainGame.playerTs){var e=(500-(s.Tools.getDistance(d.GameModel._ins.mainGame.playerTs.node.position,this.node.position)-500))/500;e>=1?e=1:e<=0&&(e=0),this.audioScale=e}},t.prototype.setRigidBody=function(e){void 0===e&&(e=!1),this.node.getComponent(cc.RigidBody).enabled!=e&&(this.node.getComponent(cc.PhysicsBoxCollider).enabled=e,this.node.getComponent(cc.RigidBody).active=e)},t.prototype.lateUpdate=function(){},t.prototype.updateMove=function(e){if(this.moveRoleAni(this.isMove),this.isMove&&this.moveToPos&&(this.lastPos=this.node.position,this.updateNavigMove(e))){var t=cc.misc.degreesToRadians(-this.tempAngle),o=Math.sin(t)*this.moveSpeed*e,n=Math.cos(t)*this.moveSpeed*e;this.node.position=cc.v3(this.node.x+o,this.node.y+n),this.roleNode.scaleX=o>0?-1:1}},t.prototype.updateMoveTime=function(e){if(this.isMove&&this.moveToPos){if(this.lastPos&&s.Tools.getDistance(this.lastPos,this.node.position)<=this.moveSpeed*e?this.defaultTime+=e:this.defaultTime=0,s.Tools.getDistance(this.moveToPos,this.node.position)<=this.moveSpeed*e&&(this.node.position=this.moveToPos),s.Tools.getDistance(this.moveToPos,this.node.position)<=this.moveSpeed*e||this.defaultTime>=3)return this.moveState=a.default,this.defaultTime=0,this.moveToPos=null,void(this.moveTime=0);this.moveToPos&&(this.moveTime+=e,this.moveTime>=2&&(this.moveTime=0,this.moveToPos=null))}},t.prototype.updateAIMove=function(e){if(this.moveState==a.toPlayer||!this.updateMovePop())return this.attackPlayerArr.length>0&&(c.GameCtrl._ins.gameState==c.GameState.Start&&this.attackPlayerArr.indexOf(d.GameModel._ins.mainGame.playerTs.node)>=0||c.GameCtrl._ins.gameState!=c.GameState.Start)?(this.movePointArr=null,void this.updateRandomToPos(e)):void(c.GameCtrl._ins.gameState==c.GameState.Start&&!this.moveToPos&&d.GameModel._ins.mainGame.enemyArr.length<=3?this.moveToPlayer():this.moveToPos||(d.GameModel._ins.mainGame.playerTs&&!this.moveToPos&&Math.random()<=.3?this.moveToPlayer():this.updateCircleMove()))},t.prototype.moveToPlayer=function(){d.GameModel._ins.mainGame.playerTs&&c.GameCtrl._ins.gameState==c.GameState.Start&&(this.moveToPos=d.GameModel._ins.mainGame.playerTs.node.position,this.moveState=a.toPlayer,this.getNavigMovePoints())},t.prototype.updateNavigMove=function(e){var t=this.moveToPos;if(this.movePointArr&&this.movePointArr.length>0){var o=l.MapCtrl._ins.mapArr[this.movePointArr[0].x][this.movePointArr[0].y];if(s.Tools.getDistance(o.position,this.node.position)<=this.moveSpeed*e)return this.node.position=o.position,this.movePointArr.splice(0,1),!1;t=o.position}return this.tempAngle=s.Tools.getAngleForPos(this.node.position,t,!0),!0},t.prototype.updateRandomToPos=function(e){this.tempRandomT+=e,this.moveToPos&&s.Tools.getDistance(this.moveToPos,this.node.position)<=this.moveSpeed*e&&(this.tempRandomT=10),this.tempRandomT>=1&&(this.moveToPos=new cc.Vec3,this.moveToPos.x=this.node.x+s.Tools.random(-this.shootRange,this.shootRange),this.moveToPos.y=this.node.y+s.Tools.random(-this.shootRange,this.shootRange),this.tempRandomT=.5*Math.random()),this.moveState=a.attackRandom},t.prototype.updateMovePop=function(){if(this.moveToPos&&this.moveState==a.toPop)return!1;for(var e=d.GameModel._ins.mainGame.popNodeArr,t=[],o=d.GameModel._ins.mainGame.CircleItem.corePos,n=d.GameModel._ins.mainGame.CircleItem.circleLen,r=0;r<e.length;r++)s.Tools.getDistance(e[r].position,this.node.position)<=500&&s.Tools.getDistance(e[r].position,o)<=n&&t.push(e[r]);for(r=0;r<t.length;r++){var i=t[r].getComponent(m.default);if(2!=i.popType||!(this.firearmNode.getComponent(f.default).armConfig.id>2||this.firearmNode.getComponent(f.default).armConfig.id==i.popID))return this.moveToPos=t[r].position,this.getNavigMovePoints(),this.moveState=a.toPop,!0}return!1},t.prototype.updateCircleMove=function(){var e=d.GameModel._ins.mainGame.CircleItem.corePos,t=d.GameModel._ins.mainGame.CircleItem.circleLen,o=l.MapCtrl._ins.getRandomCircleMap(e,t);o&&0==o.getComponent(h.default).obsType&&(this.moveToPos=o.position,this.getNavigMovePoints(),this.moveState=a.toCircle)},t.prototype.getMoveToNode=function(){var e=null,t=1e14;if(d.GameModel._ins.mainGame.playerTs&&(e=d.GameModel._ins.mainGame.playerTs.node,t=s.Tools.getDistance(e.position,this.node.position)),e&&Math.random()<=.5)this.moveToPos=e.position;else{for(var o=d.GameModel._ins.mainGame.enemyArr,n=0;n<o.length;n++){var r=o[n].node,i=s.Tools.getDistance(r.position,this.node.position);i<=t&&r!=this.node&&(t=i,e=r)}this.moveToPos=e?e.position:null}},t.prototype.getNavigMovePoints=function(){if(this.moveToPos){var e=l.MapCtrl._ins.getMapXYForPos(this.node.position),t=l.MapCtrl._ins.getMapXYForPos(this.moveToPos);e&&t?(this.movePointArr=d.GameModel._ins.mainGame.aStar.getAstar(e,t),this.movePointArr&&this.movePointArr.length>0||(this.moveToPos=null)):this.moveToPos=null}},t.prototype.onCollisionEnter=function(e,t){t.tag==u.interTag.enemyRange&&e.node!=this.node&&e.tag==u.interTag.playerBody&&s.Tools.addArrNoValue(this.attackPlayerArr,e.node),t.tag==u.interTag.enemyBody&&e.tag==u.interTag.pop&&e.node.getComponent(m.default).usePop(this.node),t.tag==u.interTag.enemyBody&&e.tag==u.interTag.grass&&(this.grassNode=e.node)},t.prototype.onCollisionExit=function(e,t){t.tag==u.interTag.enemyRange&&e.node!=this.node&&e.tag==u.interTag.playerBody&&s.Tools.removeArrForValue(this.attackPlayerArr,e.node),t.tag==u.interTag.enemyBody&&e.tag==u.interTag.grass&&(this.grassNode=null)},t.prototype.removeEnemyBack=function(){},t.prototype.addInitListener=function(){p.EventManager.addListener(p.EventData.REMOVE_ENEMY,this.removeEnemyBack.bind(this),this.node),p.EventManager.addListener(p.EventData.REMOVE_POP,this.removeEnemyBack.bind(this),this.node)},t.prototype.onDestroy=function(){p.EventManager.removeListenerForTarget(this.node)},i([v],t)}(g.default));o.default=_,function(e){e[e.default=0]="default",e[e.attackRandom=2]="attackRandom",e[e.toPop=3]="toPop",e[e.toPlayer=5]="toPlayer",e[e.toCircle=6]="toCircle"}(a||(a={})),cc._RF.pop()},{"../../common/Tools":"Tools","../../ctrl/GameCtrl":"GameCtrl","../../ctrl/MapCtrl":"MapCtrl","../../manager/EventManager":"EventManager","../../model/GameModel":"GameModel","../../model/OtherModel":"OtherModel","../floorItem":"floorItem","../popItem":"popItem","./ArmItem":"ArmItem","./Player":"Player"}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"133eazTY8lPDrziDak8SK9u","EventManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventData=o.EventManager=void 0;var n=function(){function e(){}return e.addListener=function(e,t,o){cc.director.on(e,t,o)},e.removeListener=function(e,t,o){cc.director.off(e,t,o)},e.dispachEvent=function(e,t,o,n,r,i){cc.director.emit(e,t,o,n,r,i)},e.removeListenerForTarget=function(e){cc.director.targetOff(e)},e}();o.EventManager=n,function(e){e.START_GAME="START_GAME",e.SHOW_GLOD="SHOW_GLOD",e.REIVE_GAME="REIVE_GAME",e.REMOVE_ENEMY="REMOVE_ENEMY",e.REMOVE_POP="REMOVE_POP"}(o.EventData||(o.EventData={})),cc._RF.pop()},{}],GameCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"a1d7eXYRpRDM7lzYxYf5Tki","GameCtrl"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameState=o.GameCtrl=void 0;var n,r=e("../common/ActionTools"),i=e("../common/Tools"),a=e("../manager/PoolManager"),s=e("../model/GameModel"),c=e("../model/OtherModel"),l=function(){function e(){this.boolTouch=!1}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.initGame=function(){this.gameState=n.Defualt,s.GameModel._ins.gameScore=0,s.GameModel._ins.killEnemyNum=0,s.GameModel._ins.newEnemyNum=0,s.GameModel._ins.startEnemyNum=5,this.boolTouch=!1},e.prototype.overGame=function(){this.gameState=n.Over,this.boolTouch=!1,a.PoolManager.clearAllPool()},e.prototype.getPopTypID=function(){var e=i.Tools.chooseRandom(s.GameModel._ins.addPopRandom)+1,t=i.Tools.chooseRandom(s.GameModel._ins.addPopConfig["pop_"+e])+1;return 2==e&&(t+=1),{popType:e,popID:t}},e.prototype.getAngleRotate=function(e,t,o){var n=e%360;n=e<0?360-Math.abs(n):n;var r=t<0?360-Math.abs(t):t;return Math.abs(n-r)>o&&Math.abs(n-r)<360-o?Math.abs(n-r)>180?n-r>180?e+o:e-o:n>=r?e-o:e+o:t},e.prototype.attackObsPar=function(e,t,o){for(var n=0;n<o;n++){var l=a.PoolManager.getPoolObj("bulletPar");t.obsType==c.enumObsType.box?i.Tools.setSpriteFrame(l,"boxPar_"+i.Tools.random(1,4)):i.Tools.setSpriteFrame(l,"leafPar_"+i.Tools.random(1,6)),s.GameModel._ins.mainGame.mainGame.addChild(l,2);var p=i.Tools.random(150,250);l.opacity=255,l.scale=1+Math.random(),l.stopAllActions(),l.position=e.position,l.x+=i.Tools.random(-e.width/2,e.width/2),l.y+=i.Tools.random(-e.height/2,e.height/2),l.angle=i.Tools.random(0,360);var d=r.ActionTools._ins.moveDegressAni(l,null,p,300,!1,!0);l.runAction(cc.rotateBy(.5,i.Tools.random(-360,360)).repeatForever()),l.runAction(cc.sequence(cc.delayTime(d+.1),cc.callFunc(function(e){a.PoolManager.addPoolObj(e,"bulletPar")},this)))}},e.prototype.isOutTwoArr=function(e,t,o){return e<0||t<0||e>o.length-1||t>o[0].length-1},e.prototype.getArmConfigForID=function(e){if(!(e>s.GameModel._ins.armConfig.length))return s.GameModel._ins.armConfig[e-1]},e._instance=new e,e}();o.GameCtrl=l,function(e){e[e.Defualt=0]="Defualt",e[e.Start=1]="Start",e[e.Pause=2]="Pause",e[e.Over=3]="Over",e[e.Win=4]="Win"}(n=o.GameState||(o.GameState={})),cc._RF.pop()},{"../common/ActionTools":"ActionTools","../common/Tools":"Tools","../manager/PoolManager":"PoolManager","../model/GameModel":"GameModel","../model/OtherModel":"OtherModel"}],GameModel:[function(e,t,o){"use strict";cc._RF.push(t,"a8f362i/MJKRKQHQCpCjKll","GameModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameModel=void 0;var n=function(){function e(){this.mianScene="MainGame",this.mainGame=null,this.gameScore=1,this.standScore=10,this.gameMaxScore=25,this.allEnemyNum=25,this.newEnemyNum=0,this.startEnemyNum=10,this.killEnemyNum=0,this.allObsTypeNum=2,this.obsTypeRandom=[.9,.05,.05,0,.01],this.obsHpArr=[5,20,15,0,0],this.maxPopNum=20,this.addPopTime=3,this.addPopRandom=[.8,.5],this.addPopConfig={pop_1:[1,.5,.5],pop_2:[.5,.3,.3,.2]},this.roleSkArr=["nan","nv","dabing","xiaobing"]}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e._instance=new e,e}();o.GameModel=n,cc._RF.pop()},{}],InitGame:[function(e,t,o){"use strict";cc._RF.push(t,"11d57xkx8xC/bpnzMOQ9DT5","InitGame");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/weiSanTools"),s=e("../manager/PlatformManager"),c=cc._decorator,l=c.ccclass,p=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resNodeArr=[],t.rType=s.releaseType.test_TEST,t.storageKey="",t}return r(t,e),t.prototype.onLoad=function(){s.PlatformManager.releaseType=this.rType,s.PlatformManager.storageKey=this.storageKey,s.PlatformManager.initPlatform(),this.initResNode(),this.initScreen(),a.weiSan.initLog()},t.prototype.initResNode=function(){for(var e=0;e<this.resNodeArr.length;e++){var t=cc.instantiate(this.resNodeArr[e]);this.node.addChild(t)}},t.prototype.initScreen=function(){a.weiSan.log("\u7cfb\u7edfOS: "+cc.sys.os);var e=cc.find("Canvas").getComponent(cc.Canvas);cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_IOS?(e.fitWidth=!0,e.fitHeight=!1):(e.fitWidth=!0,e.fitHeight=!0)},i([p([cc.Prefab])],t.prototype,"resNodeArr",void 0),i([p({type:cc.Enum(s.releaseType)})],t.prototype,"rType",void 0),i([p],t.prototype,"storageKey",void 0),i([l],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../common/weiSanTools":"weiSanTools","../manager/PlatformManager":"PlatformManager"}],LoadTools:[function(e,t,o){"use strict";cc._RF.push(t,"b96adtj6ztJp5Q4tD5LbQij","LoadTools"),Object.defineProperty(o,"__esModule",{value:!0}),o.LoadTools=void 0;var n=e("./Tools"),r=e("./weiSanTools"),i=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.loadScene=function(e,t,o){void 0===o&&(o=!0),o&&n.Tools.clearResDic(),cc.director.preloadScene(e,function(){cc.director.loadScene(e,t)})},e.prototype.loadResPrefab=function(e,t,o,n,r){void 0===r&&(r=0),this.loadResAny(e,cc.Prefab,function(e){var i=cc.instantiate(e);o&&o.addChild(i,r),n&&(i.position=cc.v3(n.x,n.y,0)),null!=t&&t(i)})},e.prototype.loadResSpriteFrame=function(e,t,o,n,i,a){void 0===i&&(i=0),cc.loader.loadRes(e,cc.SpriteFrame,function(e,s){e?r.weiSan.error(e):(t.getComponent(cc.Sprite).spriteFrame=s,o&&o.addChild(t,i),n&&(t.position=cc.v3(n.x,n.y,0)),null!=a&&a(t))})},e.prototype.loadResAny=function(e,t,o){cc.loader.loadRes(e,t,function(e,t){e?r.weiSan.error(e):null!=o&&o(t)})},e._instance=new e,e}();o.LoadTools=i,cc._RF.pop()},{"./Tools":"Tools","./weiSanTools":"weiSanTools"}],MainGame:[function(e,t,o){"use strict";cc._RF.push(t,"ef932zNAq1A1IMD8IZjy4f7","MainGame");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/AudioTools"),s=e("../common/Tools"),c=e("../common/weiSanTools"),l=e("../ctrl/AStar"),p=e("../ctrl/GameCtrl"),d=e("../ctrl/MapCtrl"),u=e("../item/floorItem"),h=e("../item/mainGame/circleItem"),m=e("../item/Player/ArmItem"),f=e("../item/Player/Enemy"),g=e("../item/Player/Player"),y=e("../item/popItem"),v=e("../manager/EventManager"),_=e("../manager/UIManager"),T=e("../model/GameModel"),M=e("../model/OtherModel"),A=e("../model/WordsModel"),S=cc._decorator,P=S.ccclass,C=S.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSprNode=null,t.playerTs=null,t.mainGame=null,t.bulletPool=null,t.scoreLab=null,t.smallMap=null,t.grassPool=null,t.CircleItem=null,t.junjleJson=null,t.initRolePos=[],t.mapArr=[],t.enemyArr=[],t.popNodeArr=[],t.waterNodeArr=[],t.aStar=new l.AStar,t.tempAddPop=0,t.tempAddEnmey=0,t.killLabNode=null,t}return r(t,e),t.prototype.onLoad=function(){this.gameWidth=cc.view.getVisibleSize().width,this.gameHeight=cc.view.getVisibleSize().height,cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0,this.initJsonData(),T.GameModel._ins.mainGame=this,d.MapCtrl._ins.mapArr=this.mapArr,this.addTouchEvents(),this.addInitListener()},t.prototype.initJsonData=function(){T.GameModel._ins.armConfig=this.junjleJson.json.armConfig},t.prototype.start=function(){var e=this;this.scheduleOnce(function(){e.initGame()},0)},t.prototype.update=function(e){this.updateWaterMask(),p.GameCtrl._ins.gameState==p.GameState.Start&&(this.updateAddPop(e),this.updateAddEnemy(e))},t.prototype.addTouchEvents=function(){cc.macro.ENABLE_MULTI_TOUCH=!0,this.node.on(cc.Node.EventType.TOUCH_START,this.touchStartBack,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveBack,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEndBack,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndBack,this)},t.prototype.touchStartBack=function(e){p.GameCtrl._ins.boolTouch&&(this.toushStartPos=s.Tools.getToNodePosForWorld(e.getLocation(),this.node),this.startGame(),this.playerTs.isMove=!0)},t.prototype.touchMoveBack=function(e){if(p.GameCtrl._ins.boolTouch){var t=s.Tools.getToNodePosForWorld(e.getLocation(),this.node);this.playerTs.updateRotate(this.toushStartPos,t)}},t.prototype.touchEndBack=function(){p.GameCtrl._ins.boolTouch&&(this.playerTs.isMove=!1)},t.prototype.initGame=function(){p.GameCtrl._ins.initGame(),p.GameCtrl._ins.boolTouch=!0,this.initBg(),this.updateScore(0),this.getRandomRolePos(),this.initPlayer(),this.smallMap.opacity=0},t.prototype.initPlayer=function(){var e=this;this.playerTs.initRoleData(1,3),this.playerTs.node.position=this.initRolePos[0],this.initRolePos.splice(0,1),this.playerTs.cameraNode.position=this.playerTs.node.position,this.playerTs.node.zIndex=10,d.MapCtrl._ins.forAllMapArr(function(t){if(s.Tools.getDistance(e.playerTs.node.position,t.position)<=1e3){var o=t.getComponent(u.default);null!=o.obsNode&&o.obsType!=M.enumObsType.grass&&o.obsType!=M.enumObsType.water&&(o.obsNode.destroy(),o.obsType=0)}})},t.prototype.startGame=function(){p.GameCtrl._ins.gameState!=p.GameState.Start&&(p.GameCtrl._ins.gameState=p.GameState.Start,T.GameModel._ins.gameMaxScore=T.GameModel._ins.allEnemyNum,T.GameModel._ins.standScore=T.GameModel._ins.gameMaxScore/2,this.playerTs.startGame(),this.addEnemy(),this.startAddPop(),cc.tween(this.smallMap).to(.5,{opacity:255}).start())},t.prototype.gameEnd=function(){p.GameCtrl._ins.gameState!=p.GameState.Over&&(p.GameCtrl._ins.overGame(),T.GameModel._ins.gameScore==T.GameModel._ins.gameMaxScore&&a.AudioTools._ins.playAudio("winGame"),this.playerTs.firearmNode.getComponent(m.default).attackPlayer(null),this.playerTs=null,this.node.getChildByName("smallMap").active=!1,this.scoreLab.node.active=!1,c.weiSan.log("\u6e38\u620f\u7ed3\u675f"),this.scheduleOnce(function(){_.UIManager.OpenUI("OverUI")},2))},t.prototype.initBg=function(){for(var e=0,t=0;t<d.MapCtrl._ins.maxMapX;t++){for(var o=[],n=0;n<d.MapCtrl._ins.maxMapY;n++){var r=this.newFloorPre(t,n);r.getComponent(u.default).initFloor(t,n),r.getComponent(u.default).showAni(.02*e),o.push(r)}this.mapArr.push(o),e++}this.bgSprNode.width=d.MapCtrl._ins.mapWidth,this.bgSprNode.height=d.MapCtrl._ins.mapHeight,this.initWallPre(),this.initMapTerrain(),this.initAStarMap()},t.prototype.initMapTerrain=function(){for(var e=[0,0,0,.1,0,.1],t=0;t<10;t++){var o=this.mapArr[s.Tools.random(0,this.mapArr.length-1)][s.Tools.random(0,this.mapArr[0].length-1)],n=o.getComponent(u.default);if(!(n.obsType>0)){var r=s.Tools.chooseRandom(e),i=d.MapCtrl._ins.getTerrainArr(n.mapX,n.mapY);if(i){var a=null;r==M.enumObsType.grass?a=this.newGrassNode(i,o.position):r==M.enumObsType.water&&(a=this.newWaterNode(i,o.position));for(var c=0;c<i.terrainArr.length;c++){var l=i.terrainArr[c],p=this.mapArr[l.x][l.y].getComponent(u.default);p.obsType<=0&&(r==M.enumObsType.grass&&l.y==n.mapY+i.height?p.addObs(r,a,2):p.addObs(r,a,1))}}}}d.MapCtrl._ins.forAllMapArr(function(e){var t=e.getComponent(u.default);if(0==t.obsType){var o=s.Tools.chooseRandom(T.GameModel._ins.obsTypeRandom);t.addObs(o)}})},t.prototype.initAStarMap=function(){var e=this;this.aStar.initMap(d.MapCtrl._ins.maxMapX,d.MapCtrl._ins.maxMapY,d.MapCtrl._ins.gridWidth),d.MapCtrl._ins.forAllMapArr(function(t,o,n){var r=t.getComponent(u.default);0!=r.obsType&&r.obsType!=M.enumObsType.grass&&e.aStar.setMapObs(o,n,1)})},t.prototype.initWallPre=function(){for(var e=d.MapCtrl._ins.mapWidth,t=d.MapCtrl._ins.mapHeight,o=0;o<4;o++){var n=s.Tools.newPrefab("wallPre",this.bgSprNode);o<=1?(n.width=e+n.height,n.position=cc.v3(0,0==o?t/2+n.height/2:-t/2-n.height/2)):(n.height=t+n.width,n.position=cc.v3(2==o?-e/2-n.width/2:e/2+n.width/2,0)),n.getComponent(cc.PhysicsBoxCollider).size=new cc.Size(n.width,n.height),n.getComponent(cc.PhysicsBoxCollider).apply(),n.getComponent(cc.BoxCollider).size=new cc.Size(n.width,n.height)}},t.prototype.addEnemy=function(e){if(void 0===e&&(e=1),!(T.GameModel._ins.newEnemyNum>=T.GameModel._ins.allEnemyNum||T.GameModel._ins.newEnemyNum>=T.GameModel._ins.allEnemyNum-1&&this.enemyArr.length>0)){for(var t=0;t<e;t++){var o=this.CircleItem.corePos,n=this.CircleItem.circleLen,r=d.MapCtrl._ins.getEnemyRandomPos(this.playerTs.node,o,n);if(r&&0==r.getComponent(u.default).obsType){var i;i=T.GameModel._ins.newEnemyNum==T.GameModel._ins.allEnemyNum-1?this.newBoss(r.position):this.newEnemy(r.position),this.enemyArr.push(i),T.GameModel._ins.newEnemyNum++}}this.tempAddEnmey=0}},t.prototype.startAddPop=function(){for(var e=0;e<1;e++){var t;t=0==e?this.playerTs.node:this.enemyArr[e-1].node;var o=d.MapCtrl._ins.getMapXYForPos(t.position),n=d.MapCtrl._ins.getRoundFloor(o.x,o.y),r=this.newPop(1,s.Tools.random(2,3));r.position=n.position,n.getComponent(u.default).popNode=r,r.getComponent("popItem").floorItem=n.getComponent(u.default),r.scale=0,cc.tween(r).to(.35,{scale:1}).start(),this.popNodeArr.push(r)}},t.prototype.newFloorPre=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var o=s.Tools.newPrefab("floorPre",this.bgSprNode);return o.width=d.MapCtrl._ins.gridWidth,o.height=d.MapCtrl._ins.gridWidth,o.position=cc.v3(d.MapCtrl._ins.startMapX+o.width*e,d.MapCtrl._ins.startMapY-o.height*t),o},t.prototype.newEnemy=function(e){var t=s.Tools.newPrefab("Enemy",this.mainGame,cc.v2(e.x,e.y)),o=t.getComponent(f.default);return t.opacity=0,cc.tween(t).to(.5,{opacity:255}).start(),o},t.prototype.newBoss=function(e){var t=s.Tools.newPrefab("Boss",this.mainGame,cc.v2(e.x,e.y)),o=t.getComponent(f.default);return t.opacity=0,cc.tween(t).to(.5,{opacity:255}).start(),o},t.prototype.newPop=function(e,t){var o=s.Tools.newPrefab("popNode",this.mainGame),n=d.MapCtrl._ins.getRandomCircleMap(this.CircleItem.corePos,this.CircleItem.circleLen);n&&n.getComponent(u.default).popNode||(n=d.MapCtrl._ins.getRandomFloor()),o.position=n.position,n.getComponent(u.default).popNode=o,o.getComponent(y.default).floorItem=n.getComponent(u.default);var r;return r=e?{popType:e,popID:t}:p.GameCtrl._ins.getPopTypID(),o.getComponent(y.default).initPop(r.popType,r.popID),o},t.prototype.newGrassNode=function(e,t){var o=new cc.Node;return o.width=Math.abs(2*e.width+1)*d.MapCtrl._ins.gridWidth,o.height=Math.abs(2*e.height+1)*d.MapCtrl._ins.gridWidth,o.position=t,o.addComponent(cc.BoxCollider).size=new cc.Size(o.width,o.height),o.getComponent(cc.BoxCollider).tag=M.interTag.grass,o.groupIndex=this.playerTs.node.groupIndex,this.grassPool.addChild(o),o},t.prototype.newWaterNode=function(e,t){var o=s.Tools.newPrefab("waterPre",this.bgSprNode);return o.width=Math.abs(2*e.width+1)*d.MapCtrl._ins.gridWidth,o.height=Math.abs(2*e.height+1)*d.MapCtrl._ins.gridWidth,o.position=t,o.getComponent(cc.PhysicsBoxCollider).size=new cc.Size(o.width,o.height),o.getComponent(cc.PhysicsBoxCollider).apply(),this.waterNodeArr.push(o),o},t.prototype.removeEnemy=function(e){p.GameCtrl._ins.gameState==p.GameState.Start?(this.enemyArr.indexOf(e)>=0&&(T.GameModel._ins.startEnemyNum++,T.GameModel._ins.startEnemyNum>=10&&(T.GameModel._ins.startEnemyNum=10),this.updateScore(1)),s.Tools.removeArrForValue(this.enemyArr,e),(this.playerTs.hp_num<=0||T.GameModel._ins.gameScore==T.GameModel._ins.allEnemyNum)&&(this.enemyArr.length<=0&&(this.CircleItem.isPause=!0,this.playerTs.isDeath=!0),this.gameEnd())):s.Tools.removeArrForValue(this.enemyArr,e)},t.prototype.updateAddPop=function(e){if(!(this.popNodeArr.length>=T.GameModel._ins.maxPopNum)&&(this.tempAddPop+=e,this.tempAddPop>=T.GameModel._ins.addPopTime)){var t=this.newPop();this.popNodeArr.push(t),this.tempAddPop=0,console.log("\u52a0\u65b0\u9053\u5177")}},t.prototype.updateAddEnemy=function(){this.enemyArr.length<=T.GameModel._ins.startEnemyNum&&this.addEnemy(1)},t.prototype.updateWaterMask=function(){for(var e=0;e<this.waterNodeArr.length;e++){var t=this.waterNodeArr[e].children[0].getComponent(cc.Mask)._graphics;t.clear(),t.roundRect(-this.waterNodeArr[e].width/2,-this.waterNodeArr[e].height/2,this.waterNodeArr[e].width,this.waterNodeArr[e].height,100),t.fillColor=cc.Color.WHITE,t.fill()}},t.prototype.updateScore=function(e){T.GameModel._ins.gameScore+=e;var t=T.GameModel._ins.gameMaxScore-T.GameModel._ins.gameScore;this.scoreLab.string=A.WordsModel.getStrForLanguage("surplus_1")+Math.ceil(t)+A.WordsModel.getStrForLanguage("surplus_2"),this.scoreLab.node.children[0].getComponent(cc.Label).string=A.WordsModel.getStrForLanguage("kill_3")+T.GameModel._ins.killEnemyNum+A.WordsModel.getStrForLanguage("kill_4")},t.prototype.updateKillNum=function(e){T.GameModel._ins.killEnemyNum+=e,null==this.killLabNode&&(this.killLabNode=s.Tools.newPrefab("killLab",this.mainGame,cc.v2(0,this.gameHeight/2-280))),this.killLabNode.scale=2,this.killLabNode.opacity=0,this.killLabNode.getComponent(cc.Label).string=A.WordsModel.getStrForLanguage("kill_1")+T.GameModel._ins.killEnemyNum+A.WordsModel.getStrForLanguage("kill_2"),cc.Tween.stopAllByTarget(this.killLabNode),cc.tween(this.killLabNode).to(.3,{scale:1},{easing:"backOut"}).delay(1).to(.3,{opacity:0}).start(),cc.tween(this.killLabNode).to(.1,{opacity:255}).start(),this.scoreLab.node.children[0].getComponent(cc.Label).string=A.WordsModel.getStrForLanguage("kill_3")+T.GameModel._ins.killEnemyNum+A.WordsModel.getStrForLanguage("kill_4")},t.prototype.getRandomRolePos=function(){for(var e=T.GameModel._ins.allEnemyNum+1,t=d.MapCtrl._ins.getRandomFloor(e,3,3),o=0;o<t.length;o++)this.initRolePos.push(t[o].position)},t.prototype.addInitListener=function(){v.EventManager.addListener(v.EventData.START_GAME,this.startGame.bind(this),this.node),v.EventManager.addListener(v.EventData.REMOVE_ENEMY,this.removeEnemy.bind(this),this.node)},t.prototype.onDestroy=function(){v.EventManager.removeListenerForTarget(this.node)},i([C(cc.Node)],t.prototype,"bgSprNode",void 0),i([C(g.default)],t.prototype,"playerTs",void 0),i([C(cc.Node)],t.prototype,"mainGame",void 0),i([C(cc.Node)],t.prototype,"bulletPool",void 0),i([C(cc.Label)],t.prototype,"scoreLab",void 0),i([C(cc.Node)],t.prototype,"smallMap",void 0),i([C(cc.Node)],t.prototype,"grassPool",void 0),i([C(h.default)],t.prototype,"CircleItem",void 0),i([C(cc.JsonAsset)],t.prototype,"junjleJson",void 0),i([P],t)}(cc.Component);o.default=b,cc._RF.pop()},{"../common/AudioTools":"AudioTools","../common/Tools":"Tools","../common/weiSanTools":"weiSanTools","../ctrl/AStar":"AStar","../ctrl/GameCtrl":"GameCtrl","../ctrl/MapCtrl":"MapCtrl","../item/Player/ArmItem":"ArmItem","../item/Player/Enemy":"Enemy","../item/Player/Player":"Player","../item/floorItem":"floorItem","../item/mainGame/circleItem":"circleItem","../item/popItem":"popItem","../manager/EventManager":"EventManager","../manager/UIManager":"UIManager","../model/GameModel":"GameModel","../model/OtherModel":"OtherModel","../model/WordsModel":"WordsModel"}],MapCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"7c490MWzcJMVaCyo+a29q4p","MapCtrl"),Object.defineProperty(o,"__esModule",{value:!0}),o.MapCtrl=void 0;var n=e("../common/Tools"),r=e("../item/floorItem"),i=e("../model/OtherModel"),a=e("./GameCtrl"),s=function(){function e(){this.mapArr=[],this.mapWidth=0,this.mapHeight=0,this.maxMapX=40,this.maxMapY=40,this.gridWidth=220,this.initMapData()}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.initMapData=function(){this.mapWidth=this.gridWidth*this.maxMapX,this.mapHeight=this.gridWidth*this.maxMapY,this.startMapX=-this.maxMapX*this.gridWidth/2+this.gridWidth/2,this.startMapY=this.maxMapY*this.gridWidth/2-this.gridWidth/2},e.prototype.forAllMapArr=function(e,t){void 0===t&&(t=!1);for(var o=0;o<this.mapArr.length;o++)for(var n=0;n<this.mapArr[o].length;n++){var r=e(this.mapArr[o][n],o,n);if(t&&r)return r}},e.prototype.getTerrainArr=function(e,t){var o={};return 1==n.Tools.random(1,1)&&(o=this.getBoxTerrain(e,t)),o?{terrainArr:o.tempArr,width:o.tempX,height:o.tempY}:null},e.prototype.getRandomFloor=function(e,t,o){var i=this;void 0===e&&(e=1),void 0===t&&(t=0),void 0===o&&(o=0);var a=[];if(this.forAllMapArr(function(e,n,s){if(!(n<t||n>i.mapArr.length-t-1)&&!(s<o||s>i.mapArr[0].length-o-1)&&e&&e.getComponent(r.default)){var c=e.getComponent(r.default);0!=c.obsType||c.popNode||a.push(c.node)}}),1==e)return a[n.Tools.random(0,a.length-1)];a.length<e&&(e=a.length);for(var s=n.Tools.getDiffNumRandom(0,a.length-1,e),c=[],l=0;l<s.length;l++)c.push(a[s[l]]);return c},e.prototype.getMapXYForPos=function(e){var t=Math.floor((e.x+0*this.gridWidth+this.mapWidth/2)/this.gridWidth),o=Math.floor(-(e.y-0*this.gridWidth-this.mapHeight/2)/this.gridWidth);return a.GameCtrl._ins.isOutTwoArr(t,o,this.mapArr)?null:{x:t,y:o}},e.prototype.getRandomCircleMap=function(e,t,o){if(void 0===o&&(o=1),++o>=100)return null;var a=cc.v3(e.x+n.Tools.random(-t,t),e.y+n.Tools.random(-t,t)),s=this.getMapXYForPos(a);return null===s?this.getRandomCircleMap(e,t,o):0!=this.mapArr[s.x][s.y].getComponent(r.default).obsType&&this.mapArr[s.x][s.y].getComponent(r.default).obsType!=i.enumObsType.grass?this.getRandomCircleMap(e,t,o):this.mapArr[s.x][s.y]},e.prototype.getBoxTerrain=function(e,t,o){if(void 0===o&&(o=0),++o>10)return null;var r=n.Tools.random(1,4),i=n.Tools.random(1,4);if(a.GameCtrl._ins.isOutTwoArr(e+r,t,this.mapArr)||a.GameCtrl._ins.isOutTwoArr(e-r,t,this.mapArr))return this.getBoxTerrain(e,t,o);if(a.GameCtrl._ins.isOutTwoArr(e,t+i,this.mapArr)||a.GameCtrl._ins.isOutTwoArr(e,t-i,this.mapArr))return this.getBoxTerrain(e,t,o);for(var s=[],c=-r;c<=r;c++)for(var l=-i;l<=i;l++){var p=c+e,d=l+t;if(this.getRoundFloor(p,d,!0).length<4)return null;s.push({x:p,y:d})}return{tempArr:s,tempX:r,tempY:i}},e.prototype.getRoundFloor=function(e,t,o){void 0===o&&(o=!1);var r=[];return this.addArrRound(e+1,t,this.mapArr,r),this.addArrRound(e-1,t,this.mapArr,r),this.addArrRound(e,t+1,this.mapArr,r),this.addArrRound(e,t-1,this.mapArr,r),r.length>0?o?r:r[n.Tools.random(0,r.length-1)]:o?[this.mapArr[e][t]]:this.mapArr[e][t]},e.prototype.addArrRound=function(e,t,o,n){var r=this.getMapObsType(o,e,t);null!==r&&0===r&&n.push(o[e][t])},e.prototype.getMapObsType=function(e,t,o){return a.GameCtrl._ins.isOutTwoArr(t,o,e)?null:e[t][o].getComponent(r.default).obsType},e.prototype.getEnemyRandomPos=function(e,t,o){var i=[];this.forAllMapArr(function(t){if(n.Tools.getDistance(e.position,t.position)>=1e3){var o=t.getComponent(r.default);null==o.obsNode&&0==o.obsType&&i.push(o)}});for(var a=[],s=0;s<i.length;s++)n.Tools.getDistance(i[s].node.position,t)<=o&&a.push(i[s]);return a.length>0?a[n.Tools.random(0,a.length-1)].node:i[n.Tools.random(0,a.length-1)].node},e._instance=new e,e}();o.MapCtrl=s,cc._RF.pop()},{"../common/Tools":"Tools","../item/floorItem":"floorItem","../model/OtherModel":"OtherModel","./GameCtrl":"GameCtrl"}],NetworkManager:[function(e,t,o){"use strict";cc._RF.push(t,"7368bvx8K9EabyOcKON6XK5","NetworkManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.msgHttpUrl=o.NetworkManager=void 0;var n=e("../common/weiSanTools"),r=e("./PlatformManager"),i=function(){function e(){}return e.initNetwork=function(){r.PlatformManager.releaseType==r.releaseType.h5_common||r.PlatformManager.releaseType==r.releaseType.h5_weiSan?this.initNet_H5():r.PlatformManager.releaseType==r.releaseType.test_TEST&&(this.moreGameUrl="http://m.wesane.com/",n.weiSan.log("\u53d1\u9001:---\u6e38\u620f\u52a0\u8f7d\u6210\u529f!"))},e.initNet_H5=function(){this.getHttpGameId(),this.sendLoadGame()},e.getHttpGameId=function(){var e=document.URL,t=0;if(r.PlatformManager.releaseType==r.releaseType.h5_common){var i=window.location.href,a=i.substring(0,i.lastIndexOf("//")+2),s=window.location.host,c=(e=document.URL).lastIndexOf("/"),l=e.substring(0,c);c=l.lastIndexOf("/"),t=parseInt(l.substring(c+1,l.length)),this.gameHttpId=t,console.log("gameIdNew",t),i.substring(i.lastIndexOf("//")+4,i.lastIndexOf("com")+3);var p=a+s,d=p.lastIndexOf("//"),u=p.substring(d+2,p.indexOf("//")+4);if("g."==u){var h=p.replace(u,"");p=h}else console.log("noChange");this.moreGameUrl=p,o.msgHttpUrl.gamePv_commonH5=a+s+"/Service/GamePv/index",o.msgHttpUrl.score_commonH5=a+s+"/Service/Score/index"}else{var m=e.substring(e.lastIndexOf("/game/")+1,e.length).split("/");m.length>=2&&(t=parseInt(m[1])),this.moreGameUrl="http://m.wesane.com/"}this.gameHttpId=t,n.weiSan.log("gameId:",t)},e.sendLoadGame=function(){r.PlatformManager.releaseType==r.releaseType.h5_weiSan?this.sendMsg(o.msgHttpUrl.gamePv_weiSanH5,"gameID="+this.gameHttpId.toString(),this.loadGameBack):r.PlatformManager.releaseType==r.releaseType.h5_common&&this.sendMsg(o.msgHttpUrl.gamePv_commonH5,"gameId="+this.gameHttpId.toString(),this.loadGameBack)},e.loadGameBack=function(){n.weiSan.log("gamePv\u52a0\u8f7d\u6210\u529f")},e.sendGameScore=function(e,t){r.PlatformManager.releaseType==r.releaseType.h5_weiSan?this.sendMsg(o.msgHttpUrl.score_weiSanH5,"gameScore="+e+"&gameId="+this.gameHttpId+"&gameType="+t,this.sendScoreBack):r.PlatformManager.releaseType==r.releaseType.h5_common&&this.sendMsg(o.msgHttpUrl.score_commonH5,"gameScore="+e+"&gameId="+this.gameHttpId+"&gameType="+t,this.sendScoreBack)},e.sendScoreBack=function(e){n.weiSan.log("---\u63d0\u4ea4\u5206\u6570\u6210\u529f!"+e),null!=e.currentTarget.response&&""!=e.currentTarget.response&&JSON.parse(e.currentTarget.response)},e.sendMsg=function(e,t,o){var n=cc.loader.getXMLHttpRequest();n.onreadystatechange=o,n.open("POST",e),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(t)},e.gameHttpId=0,e}();o.NetworkManager=i,window.NetworkManager=i,o.msgHttpUrl={gamePv_weiSanH5:"http://www.wesane.com/admin.php/Activityshow/gamelogo",score_weiSanH5:"http://www.wesane.com/admin.php/Gamescore/saveGamescore",gamePv_commonH5:"",score_commonH5:""},cc._RF.pop()},{"../common/weiSanTools":"weiSanTools","./PlatformManager":"PlatformManager"}],OtherModel:[function(e,t,o){"use strict";cc._RF.push(t,"a7d991QTY1Bt7JTY7l9t4I2","OtherModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.enumObsType=o.interTag=o.groupAll=o.zIndexAll=void 0,function(e){e[e.player_Z=10]="player_Z",e[e.bg_Z=1]="bg_Z"}(o.zIndexAll||(o.zIndexAll={})),function(e){e[e.default=0]="default",e[e.UI=2]="UI"}(o.groupAll||(o.groupAll={})),function(e){e[e.playerBody=1]="playerBody",e[e.playerRange=2]="playerRange",e[e.enemyBody=3]="enemyBody",e[e.enemyRange=4]="enemyRange",e[e.playerBullet=5]="playerBullet",e[e.enemyBullet=6]="enemyBullet",e[e.obs=7]="obs",e[e.wall=8]="wall",e[e.pop=9]="pop",e[e.grass=10]="grass"}(o.interTag||(o.interTag={})),function(e){e[e.box=1]="box",e[e.tree=2]="tree",e[e.grass=3]="grass",e[e.obs=4]="obs",e[e.water=5]="water"}(o.enumObsType||(o.enumObsType={})),cc._RF.pop()},{}],OverUI:[function(e,t,o){"use strict";cc._RF.push(t,"eef84sRpGtEYKFhq3Zv4xGF","OverUI");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../ads/AdManager"),s=e("../common/Tools"),c=e("../common/weiSanTools"),l=e("../manager/NetworkManager"),p=e("../manager/PlatformManager"),d=e("../manager/UIManager"),u=e("../model/GameModel"),h=e("../model/WordsModel"),m=cc._decorator,f=m.ccclass,g=m.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSpr=null,t.viewNode=null,t.scoreLab=null,t.maxScoreLab=null,t.infoText=null,t.moreBtn=null,t.aginBtn=null,t.isClick=!1,t.chickenSpr=null,t}return r(t,e),t.prototype.onLoad=function(){this.bgSpr.opacity=0,this.viewNode.x-=1e3,this.aginBtn.scale=0,this.moreBtn.x-=200,this.initShowInfo(),this.addBtnEvent(),l.NetworkManager.sendGameScore(u.GameModel._ins.gameScore,1),p.PlatformManager.osType!=p.osType.h5&&(this.moreBtn.active=!1),this.showWinInfo()},t.prototype.showWinInfo=function(){var e=u.GameModel._ins.gameScore==u.GameModel._ins.gameMaxScore;this.viewNode.getChildByName("winSpr").active=e,this.viewNode.getChildByName("overSpr").active=!e,this.chickenSpr=this.viewNode.getChildByName("chickenSpr"),this.chickenSpr.children[1].active=e,this.scoreLab.string=u.GameModel._ins.gameScore.toString()},t.prototype.winAni=function(){var e=this;cc.tween(this.chickenSpr).call(function(){u.GameModel._ins.gameScore==u.GameModel._ins.gameMaxScore&&e.starAni(),e.overOpenAni()}).start()},t.prototype.starAni=function(){for(var e=this,t=function(){var t=s.Tools.newSprite("winStar",o.chickenSpr);t.groupIndex=o.node.groupIndex,t.opacity=0,cc.tween(t).delay(1*Math.random()).call(function(){t.scale=.7*Math.random()+.3,t.opacity=0,t.angle=s.Tools.random(0,360),t.x=s.Tools.random(-e.chickenSpr.width/2,e.chickenSpr.width/2),t.y=s.Tools.random(-e.chickenSpr.height/2,e.chickenSpr.height)}).to(.35,{opacity:s.Tools.random(180,255)}).to(.35,{opacity:0}).union().repeatForever().start()},o=this,n=0;n<10;n++)t()},t.prototype.initShowInfo=function(){this.scoreLab.string=u.GameModel._ins.gameScore.toString();var e=this.getBeatItScore(u.GameModel._ins.gameScore,u.GameModel._ins.standScore,u.GameModel._ins.gameMaxScore);this.infoText.string=this.getBeatItStr(u.GameModel._ins.gameScore,e,!0);var t=s.Tools.getStorage("gameOverMaxScore");(!t||t<=u.GameModel._ins.gameScore)&&(t=u.GameModel._ins.gameScore,s.Tools.setStorage("gameOverMaxScore",u.GameModel._ins.gameScore)),this.maxScoreLab.string=t.toString(),p.PlatformManager.osType==p.osType.h5&&("CN"==s.Tools.getLanguageType()||"CHT"==s.Tools.getLanguageType()?document.title=h.WordsModel.getStrForLanguage("overTitle_1","CN")+"<"+h.WordsModel.getStrForLanguage("gameName","CN")+">"+h.WordsModel.getStrForLanguage("overTitle_2","CN")+this.getBeatItStr(u.GameModel._ins.gameScore,e,!1):document.title=h.WordsModel.getStrForLanguage("overTitle_1","EN")+"<"+h.WordsModel.getStrForLanguage("gameName","EN")+">"+h.WordsModel.getStrForLanguage("overTitle_2","EN")+this.getBeatItStr(u.GameModel._ins.gameScore,e,!1),console.log(document.title))},t.prototype.addBtnEvent=function(){var e=this;this.aginBtn.on("click",function(){e.isClick&&e.aginGame()}),this.moreBtn.on("click",function(){e.isClick&&(p.PlatformManager.releaseType!=p.releaseType.test_TEST?(e.isClick=!1,window.location.href=l.NetworkManager.moreGameUrl):c.weiSan.log("\u6d4b\u8bd5\u6a21\u5f0f \u66f4\u591a\u6e38\u620fUrl: "+l.NetworkManager.moreGameUrl))})},t.prototype.aginGame=function(){this.isClick=!1,d.UIManager.CloseUI("OverUI"),this.scheduleOnce(function(){cc.director.preloadScene(u.GameModel._ins.mianScene,function(){cc.director.loadScene(u.GameModel._ins.mianScene)})},.2)},t.prototype.getBeatItStr=function(e,t,o){void 0===o&&(o=!0);var n=h.WordsModel.getStrForLanguage("overScoreInfo_0");return e>0&&(n=h.WordsModel.getStrForLanguage("overScoreInfo_1")+t+"%"+h.WordsModel.getStrForLanguage("overScoreInfo_2")),n},t.prototype.getBeatItScore=function(e,t,o){if(e>=o)return 100;if(e<=t){var n=e/t*80+s.Tools.random(-3,3);return Math.max(Math.floor(n),5)}return n=80+(e-t)/(o-t)*20+s.Tools.random(-3,3),Math.min(Math.floor(n),99)},t.prototype.openUI=function(){var e=u.GameModel._ins.gameScore==u.GameModel._ins.gameMaxScore;this.winAni(),e||this.node.getChildByName("fireNode").destroy()},t.prototype.overOpenAni=function(){var e=this;this.bgSpr.runAction(cc.fadeTo(.3,120)),this.viewNode.runAction(cc.sequence(cc.moveBy(.3,cc.v2(1e3,0)).easing(cc.easeBackOut()),cc.callFunc(function(){e.isClick=!0,e.aginBtn.runAction(cc.scaleTo(.3,1).easing(cc.easeBackOut())),e.moreBtn.runAction(cc.moveBy(.3,cc.v2(200,0)).easing(cc.easeBackOut())),s.Tools.setNodeParent(e.chickenSpr,e.viewNode)})))},t.prototype.closeUI=function(){this.bgSpr.runAction(cc.fadeOut(.3)),this.viewNode.runAction(cc.moveBy(.3,cc.v2(0,1e3)).easing(cc.easeBackIn())),this.moreBtn.runAction(cc.moveBy(.3,cc.v2(-200,0)).easing(cc.easeBackIn()))},i([g(cc.Node)],t.prototype,"bgSpr",void 0),i([g(cc.Node)],t.prototype,"viewNode",void 0),i([g(cc.Label)],t.prototype,"scoreLab",void 0),i([g(cc.Label)],t.prototype,"maxScoreLab",void 0),i([g(cc.Label)],t.prototype,"infoText",void 0),i([g(cc.Node)],t.prototype,"moreBtn",void 0),i([g(cc.Node)],t.prototype,"aginBtn",void 0),i([f],t)}(d.UIManager);o.default=y,cc._RF.pop()},{"../ads/AdManager":"AdManager","../common/Tools":"Tools","../common/weiSanTools":"weiSanTools","../manager/NetworkManager":"NetworkManager","../manager/PlatformManager":"PlatformManager","../manager/UIManager":"UIManager","../model/GameModel":"GameModel","../model/WordsModel":"WordsModel"}],PlatformManager:[function(e,t,o){"use strict";cc._RF.push(t,"526f4NSDmdHDqwXmWoL2A3b","PlatformManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.osType=o.releaseType=o.PlatformManager=void 0;var n,r=e("../ads/AdManager"),i=e("./NetworkManager"),a=function(){function e(){}return e.initPlatform=function(){this.loadGameBool||(this.initOsType(),i.NetworkManager.initNetwork(),e.releaseType!=o.releaseType.h5_weiSan&&e.releaseType!=o.releaseType.h5_common||("NaN"==i.NetworkManager.gameHttpId.toString(),loadInScene&&loadInScene(),cc.view.enableAutoFullScreen(!1)),e.releaseType!=o.releaseType.applet_ziJie&&(window.AdManager=r.AdManager),this.loadGameBool=!0)},e.initOsType=function(){this.releaseType==o.releaseType.APP_google?this.osType=n.android:this.releaseType==o.releaseType.APP_ios?this.osType=n.ios:this.releaseType==o.releaseType.applet_ziJie?this.osType=n.applet:this.osType=n.h5},e.setStorage=function(t,n,r){if(void 0===r&&(r=!1),t=this.storageKey+t,e.releaseType===o.releaseType.applet_ziJie)return tt.setStorageSync(t,n);r&&(n=JSON.stringify(n)),cc.sys.localStorage.setItem(t,n)},e.getStorage=function(t,n){void 0===n&&(n=!1),t=this.storageKey+t;var r=null;return e.releaseType===o.releaseType.applet_ziJie?r=tt.getStorageSync(t):(r=cc.sys.localStorage.getItem(t))&&"NaN"!=r.toString()&&"null"!=r.toString()?n?r=JSON.parse(r):isNaN(r)||(r=parseInt(r)):r=null,r},e.storageKey="demo_Game_",e.loadGameBool=!1,e}();o.PlatformManager=a,window.PlatformManager=a,o.releaseType=cc.Enum({test_TEST:1,h5_weiSan:2,h5_common:3,applet_ziJie:4,APP_google:5,APP_ios:6}),function(e){e[e.h5=1]="h5",e[e.android=2]="android",e[e.ios=3]="ios",e[e.applet=4]="applet"}(n=o.osType||(o.osType={})),cc._RF.pop()},{"../ads/AdManager":"AdManager","./NetworkManager":"NetworkManager"}],Player:[function(e,t,o){"use strict";cc._RF.push(t,"243edj9h0JOgpvd7zmJQk6y","Player");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/AudioTools"),s=e("../../common/Tools"),c=e("../../ctrl/GameCtrl"),l=e("../../ctrl/MapCtrl"),p=e("../../manager/EventManager"),d=e("../../model/GameModel"),u=e("../../model/OtherModel"),h=e("../CameraItem"),m=e("../floorItem"),f=e("../popItem"),g=e("./ArmItem"),y=cc._decorator,v=y.ccclass,_=y.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cameraNode=null,t.roleNode=null,t.firearmNode=null,t.attackRange=null,t.sliderSpr=null,t.acSpr=null,t.helmetNode=null,t.clothesNode=null,t.roleID=1,t.moveSpeed=600,t.tempAngle=0,t.shootRange=800,t.isMove=!1,t.isDeath=!1,t.hp_max=200,t.hp_num=100,t.ac_head=0,t.ac_body=0,t.ac_max=100,t.audioScale=1,t.armAudio=null,t.attackPlayerArr=[],t.attackObsArr=[],t.roleSkeleton=null,t.fireStar=null,t.upSliderSpeed=.05,t.armID=0,t.circleTween=null,t.bool_inPosion=!1,t.moveAniTween=null,t.bool_isGrass=!1,t.grassNode=null,t}var o;return r(t,e),o=t,t.prototype.onLoad=function(){this.roleSkeleton=this.roleNode.getComponent(sp.Skeleton),this.fireStar=this.firearmNode.getChildByName("fireStar"),this.helmetNode.active=!1,this.clothesNode.active=!1,this.roleSkeleton.paused=!0},t.prototype.startGame=function(){this.cameraNode.getComponent(h.default).zoomTatioTween(.3,.45),this.showRange()},t.prototype.initRoleData=function(e,t){this.switchArm(e),this.switchRoleSkin(t),this.hp_num=this.hp_max},t.prototype.update=function(e){this.updateSlider(),c.GameCtrl._ins.gameState==c.GameState.Start&&(this.isDeath||(this.updateMove(e),this.updateAttack()))},t.prototype.lateUpdate=function(){if(c.GameCtrl._ins.gameState==c.GameState.Start){this.cameraNode.position=this.node.position;var e=cc.winSize.height/this.cameraNode.getComponent(cc.Camera).zoomRatio,t=cc.winSize.width/this.cameraNode.getComponent(cc.Camera).zoomRatio,o=(l.MapCtrl._ins.mapWidth+800)/2-t/2,n=(l.MapCtrl._ins.mapHeight+800)/2-e/2;Math.abs(this.cameraNode.x)>=o&&(this.cameraNode.x=this.node.x>0?o:-o),Math.abs(this.cameraNode.y)>=n&&(this.cameraNode.y=this.node.y>0?n:-n)}},t.prototype.updateRotate=function(e,t){this.tempAngle=s.Tools.getAngleForPos(e,t,!0)},t.prototype.updateMove=function(e){if(this.moveRoleAni(this.isMove),this.isMove){var t=cc.misc.degreesToRadians(-this.tempAngle),o=Math.sin(t)*this.moveSpeed*e,n=Math.cos(t)*this.moveSpeed*e;this.node.position=cc.v3(this.node.x+o,this.node.y+n),this.roleNode.scaleX=o>0?-1:1}},t.prototype.updateAttack=function(){var e=this.getAttackArr();if(e.length<=0)if(this.attackObsArr.length>0){var t=this.getAttackNode(this.attackObsArr);this.firearmNode.getComponent(g.default).attackPlayer(t.parent)}else this.firearmNode.getComponent(g.default).attackPlayer(null);else if(c.GameCtrl._ins.gameState==c.GameState.Start&&e.indexOf(d.GameModel._ins.mainGame.playerTs.node)>=0){var o=d.GameModel._ins.mainGame.playerTs.node;this.firearmNode.getComponent(g.default).attackPlayer(o)}else{var n=this.getAttackNode(this.attackPlayerArr);this.firearmNode.getComponent(g.default).attackPlayer(n)}},t.prototype.getAttackArr=function(){for(var e=[],t=0;t<this.attackPlayerArr.length;t++){var n=this.attackPlayerArr[t];null==this.grassNode&&n.getComponent(o).grassNode||e.push(n)}return e},t.prototype.getAttackNode=function(e){for(var t=e[0],o=1e15,n=0;n<e.length;n++){var r=s.Tools.getToNodePosForNode(e[n],this.node.parent),i=s.Tools.getDistance(this.node.position,r);i<=o&&(t=e[n],o=i)}return t},t.prototype.updateSlider=function(){var e=(this.ac_body+this.ac_head)/this.ac_max;this.updateSprFill(this.acSpr,e);var t=this.hp_num/this.hp_max;this.updateSprFill(this.sliderSpr,t)},t.prototype.updateSprFill=function(e,t){if(e.fillRange!=t)if(Math.abs(e.fillRange-t)<=this.upSliderSpeed)e.fillRange=t;else{var o=e.fillRange<=t?this.upSliderSpeed:-this.upSliderSpeed;e.fillRange+=o}},t.prototype.updateHpNum=function(e){if(e<0){if(this.ac_head>0)return this.ac_head+=e,void(this.helmetNode.active=this.ac_head>0);if(this.ac_body>0)return this.ac_body+=e,void(this.clothesNode.active=this.ac_body>0)}else this.addHpAni();this.hp_num+=e,this.hp_num<=0&&(this.hp_num=0),this.hp_num>=this.hp_max&&(this.hp_num=this.hp_num)},t.prototype.addAcNum=function(e){void 0===e&&(e=2),2==e?this.ac_head=50:3==e&&(this.ac_body=50),this.helmetNode.active=this.ac_head>0,this.clothesNode.active=this.ac_body>0},t.prototype.switchArm=function(e){void 0===e&&(e=1),this.armID=e,this.firearmNode.destroy(),this.firearmNode=s.Tools.newPrefab("firearm_"+e,this.node);var t=d.GameModel._ins.armConfig[e-1],o="Player"==this.node.name;this.firearmNode.getComponent(g.default).setArmData(t,o),this.node.getComponent(cc.CircleCollider).radius=this.shootRange,this.fireStar=this.firearmNode.getChildByName("fireStar")},t.prototype.switchRoleSkin=function(e){this.roleID=e,this.roleSkeleton.animation="dabing"+(2*this.roleID-1)},t.prototype.addHpAni=function(){for(var e=function(){var e=cc.v2(s.Tools.random(-t.node.width/2,t.node.width/2),s.Tools.random(0,.5*t.node.height)),o=s.Tools.newSprite("pop_1",t.node,e,t.node.zIndex+1);o.scale=0,o.opacity=180,o.groupIndex=t.node.groupIndex;var n=.3+.3*Math.random(),r=.3*Math.random();cc.tween(o).delay(r).call(function(t){t.position=cc.v3(e.x,e.y)}).to(.2,{scale:n},{easing:"backOut"}).delay(.8-.2-.2).to(.2,{opacity:0}).start(),cc.tween(o).delay(r).by(.8,{position:cc.v3(0,200)}).call(function(e){e.destroy()}).start()},t=this,o=0;o<10;o++)e()},t.prototype.showRange=function(e){void 0===e&&(e=!1);var t=2*this.shootRange/this.attackRange.width;e?(cc.Tween.stopAllByTarget(this.attackRange),cc.tween(this.attackRange).to(.5,{scale:t},{easing:cc.easing.backInOut}).start()):this.attackRange.scale=t},t.prototype.hideRange=function(){this.attackRange.active=!1},t.prototype.unAttack=function(e,t){this.isDeath||(this.updateHpNum(-e),this.hp_num<=0&&(p.EventManager.dispachEvent(p.EventData.REMOVE_ENEMY,this),this.node.getComponent(cc.BoxCollider).destroy(),this.node.getComponent(cc.CircleCollider).destroy(),this.deathAni(),this.isDeath=!0,t==u.interTag.playerBullet&&d.GameModel._ins.mainGame.updateKillNum(1),a.AudioTools._ins.playAudio("death_nan",1.5*this.audioScale),this.firearmNode.getComponent(g.default).stopFire()))},t.prototype.inCircle=function(){var e=this;this.bool_inPosion=!0,this.circleTween&&this.circleTween.stop();var t=this.sliderSpr.node.parent;this.circleTween=cc.tween(t).to(.5,{color:cc.Color.RED}).call(function(){e.unAttack(5,3)}).to(.3,{color:cc.Color.WHITE}).delay(.2).union().repeatForever().start()},t.prototype.outCircle=function(){if(this.bool_inPosion=!1,this.circleTween){this.circleTween.stop();var e=this.sliderSpr.node.parent;this.circleTween=cc.tween(e).to(.5,{color:cc.Color.WHITE}).start()}},t.prototype.deathAni=function(){var e=this;this.isMove=!1,d.GameModel._ins.roleSkArr[this.roleID-1],this.scheduleOnce(function(){e.roleSkeleton.animation="dabing"+2*e.roleID,e.roleSkeleton.loop=!1,e.roleSkeleton.paused=!1},0),cc.tween(this.node).delay(.3).call(function(){e.deathStoneAni(),e.smokeParAni()}).to(.3,{opacity:0}).call(function(){e.deathAddPop(),e.node.destroy()}).start()},t.prototype.deathStoneAni=function(){var e=cc.v2(this.node.x,this.node.y+300),t=s.Tools.newSprite("deathStone",d.GameModel._ins.mainGame.bgSprNode,e);t.groupIndex=this.node.groupIndex,t.opacity=0,t.scale=3,cc.tween(t).by(.1,{opacity:255}).start(),cc.tween(t).by(.3,{position:cc.v3(0,-300)},{easing:"sineIn"}).delay(1).to(.3,{opacity:255}).start();for(var o=function(){var e=s.Tools.newSprite("humanHead",n.node.parent,cc.v2(n.node.x,n.node.y+100),12);e.opacity=0,e.scale=1+Math.random(),e.groupIndex=n.node.groupIndex,e.x+=s.Tools.random(-n.node.width/2,n.node.width/2);var t=1*Math.random();cc.tween(e).delay(t).call(function(){cc.tween(e).to(.5,{skewX:-10}).to(.5,{skewX:10}).union().repeatForever().start()}).by(1,{opacity:255,position:cc.v3(0,s.Tools.random(100,200))},{easing:"sineOut"}).to(.3,{opacity:0}).call(function(e){e.destroy()}).start()},n=this,r=0;r<5;r++)o()},t.prototype.smokeParAni=function(){for(var e=0;e<20;e++){var t=s.Tools.newSprite("smoke_"+s.Tools.random(1,3),this.node.parent,cc.v2(this.node.x,this.node.y),10);t.x+=s.Tools.random(-this.node.width/2,this.node.width/2),t.y+=s.Tools.random(-this.node.height/2,.8*this.node.height),t.scale=1.5+Math.random(),t.opacity=0,t.angle=s.Tools.random(0,360),t.groupIndex=this.node.groupIndex;var o=s.Tools.random(-200,200),n=Math.abs(o)/300;cc.tween(t).to(.1,{opacity:s.Tools.random(150,255)}).delay(n-.1).to(.15,{opacity:0}).call(function(e){e.destroy()}).start(),cc.tween(t).by(n,{position:cc.v3(o,0)},{easing:"sineOut"}).start()}},t.prototype.moveRoleAni=function(e){!e&&this.moveAniTween?(this.moveAniTween.stop(),this.moveAniTween=null,cc.tween(this.roleNode).to(.15,{position:cc.v3(0,-93)}).start(),this.roleSkeleton.paused=!0,this.roleSkeleton.setBonesToSetupPose()):e&&!this.moveAniTween&&(cc.Tween.stopAllByTarget(this.roleNode),this.moveAniTween=cc.tween(this.roleNode).to(.15,{position:cc.v3(0,-73)},{easing:"sineOut"}).to(.15,{position:cc.v3(0,-93)},{easing:"sineIn"}).union().repeatForever().start(),this.roleSkeleton.paused=!1)},t.prototype.deathAddPop=function(){var e=this.firearmNode.getComponent(g.default).armConfig;if(1!=e.id){var t=d.GameModel._ins.mainGame.newPop(2,e.id);t.position=this.node.position;var o=l.MapCtrl._ins.getMapXYForPos(this.node.position);if(o){var n=l.MapCtrl._ins.getRoundFloor(o.x,o.y);n.getComponent(m.default).popNode?t.destroy():(n.getComponent(m.default).popNode=t,t.getComponent(f.default).floorItem=n.getComponent(m.default),d.GameModel._ins.mainGame.popNodeArr.push(t),t.scale=0,cc.tween(t).to(.35,{position:n.position,scale:1}).start())}else t.destroy()}},t.prototype.onCollisionEnter=function(e,t){if(t.tag==u.interTag.playerRange&&e.tag==u.interTag.enemyBody&&s.Tools.addArrNoValue(this.attackPlayerArr,e.node),t.tag==u.interTag.playerRange&&e.tag==u.interTag.obs){var o=e.node.parent.getComponent(m.default).obsType;o!=u.enumObsType.water&&o!=u.enumObsType.obs&&s.Tools.addArrNoValue(this.attackObsArr,e.node)}t.tag==u.interTag.playerBody&&e.tag==u.interTag.pop&&e.node.getComponent(f.default).usePop(this.node)&&a.AudioTools._ins.playAudio("eatPop",1),t.tag==u.interTag.playerBody&&e.tag==u.interTag.grass&&(e.node.opacity=180,this.grassNode=e.node)},t.prototype.onCollisionStay=function(e,t){if(t.tag==u.interTag.playerRange&&e.tag==u.interTag.obs){var o=e.node.parent.getComponent(m.default).obsType;o!=u.enumObsType.water&&o!=u.enumObsType.obs&&s.Tools.addArrNoValue(this.attackObsArr,e.node)}},t.prototype.onCollisionExit=function(e,t){c.GameCtrl._ins.gameState!=c.GameState.Over&&(t.tag==u.interTag.playerRange&&e.tag==u.interTag.enemyBody&&s.Tools.removeArrForValue(this.attackPlayerArr,e.node),t.tag==u.interTag.playerRange&&e.tag==u.interTag.obs&&s.Tools.removeArrForValue(this.attackObsArr,e.node),t.tag==u.interTag.playerBody&&e.tag==u.interTag.grass&&(e.node.opacity=255,this.grassNode=null))},i([_(cc.Node)],t.prototype,"cameraNode",void 0),i([_(cc.Node)],t.prototype,"roleNode",void 0),i([_(cc.Node)],t.prototype,"firearmNode",void 0),i([_(cc.Node)],t.prototype,"attackRange",void 0),i([_(cc.Sprite)],t.prototype,"sliderSpr",void 0),i([_(cc.Sprite)],t.prototype,"acSpr",void 0),i([_(cc.Node)],t.prototype,"helmetNode",void 0),i([_(cc.Node)],t.prototype,"clothesNode",void 0),o=i([v],t)}(cc.Component);o.default=T,cc._RF.pop()},{"../../common/AudioTools":"AudioTools","../../common/Tools":"Tools","../../ctrl/GameCtrl":"GameCtrl","../../ctrl/MapCtrl":"MapCtrl","../../manager/EventManager":"EventManager","../../model/GameModel":"GameModel","../../model/OtherModel":"OtherModel","../CameraItem":"CameraItem","../floorItem":"floorItem","../popItem":"popItem","./ArmItem":"ArmItem"}],PoolManager:[function(e,t,o){"use strict";cc._RF.push(t,"6d71a4IRmhHHqQ3Zkrz3M5U","PoolManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.PoolManager=void 0;var n=e("../common/Tools"),r=e("../common/weiSanTools"),i=function(){function e(){}return e.addPoolObj=function(e,t){t=t||e.name,null==this.PoolDic[e.name]&&(this.PoolDic[e.name]=new cc.NodePool(e.name)),this.PoolDic[e.name].put(e)},e.getPoolObj=function(e){return null==this.PoolDic[e]?(r.weiSan.warn("\u6ca1\u6709\u6dfb\u52a0\u5bf9\u8c61\u6c60\uff1a",e),this.PoolDic[e]=new cc.NodePool(e),n.Tools.newPrefab(e)):this.PoolDic[e].size()>1?this.PoolDic[e].get():n.Tools.newPrefab(e)},e.clearPool=function(e){if(null!=this.PoolDic[e])return this.PoolDic[e].clear();r.weiSan.warn("\u6ca1\u6709\u6dfb\u52a0\u5bf9\u8c61\u6c60\uff1a",e)},e.clearAllPool=function(){for(var e in this.PoolDic)Object.prototype.hasOwnProperty.call(this.PoolDic,e)&&this.clearPool(e)},e.PoolDic=new Map,e}();o.PoolManager=i,cc._RF.pop()},{"../common/Tools":"Tools","../common/weiSanTools":"weiSanTools"}],ResArr:[function(e,t,o){"use strict";cc._RF.push(t,"56af2D00XFDX6lyw8ZO/zKX","ResArr");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/Tools"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SpriteFrameArr=[],t.PrefabArr=[],t.audiosArr=[],t}return r(t,e),t.prototype.onLoad=function(){this.addAudio(),this.addPrefabs(),this.addSpriteFrame()},t.prototype.addAudio=function(){for(var e=0;e<this.audiosArr.length;e++)if(this.audiosArr[e]){var t=this.audiosArr[e];a.Tools.AudioClipDic.set(t.name,t)}},t.prototype.addSpriteFrame=function(){for(var e=0;e<this.SpriteFrameArr.length;e++)if(this.SpriteFrameArr[e]){var t=this.SpriteFrameArr[e];a.Tools.SpriteFrameDic.set(t.name,t)}},t.prototype.addPrefabs=function(){for(var e=0;e<this.PrefabArr.length;e++)if(this.PrefabArr[e]){var t=this.PrefabArr[e];a.Tools.PrefabDic.set(t.data.name,t)}},i([l([cc.SpriteFrame])],t.prototype,"SpriteFrameArr",void 0),i([l([cc.Prefab])],t.prototype,"PrefabArr",void 0),i([l([cc.AudioClip])],t.prototype,"audiosArr",void 0),i([c],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../common/Tools":"Tools"}],Tools:[function(e,t,o){"use strict";cc._RF.push(t,"1cabc0YRwVLlaPoVAuI9R3d","Tools"),Object.defineProperty(o,"__esModule",{value:!0}),o.Tools=void 0;var n=e("../manager/PlatformManager"),r=e("./LoadTools"),i=function(){function e(){}return e.clearResDic=function(){this.AudioClipDic.clear(),this.SpriteFrameDic.clear(),this.PrefabDic.clear()},e.setStorage=function(e,t,o){void 0===o&&(o=!1),n.PlatformManager.setStorage(e,t,o)},e.getStorage=function(e,t){return void 0===t&&(t=!1),n.PlatformManager.getStorage(e,t)},e.newPrefab=function(e,t,o,n,r){return void 0===n&&(n=0),a._ins.newPrefab(e,r,t,o,n)},e.newSprite=function(e,t,o,n,r){return void 0===n&&(n=0),a._ins.newSprite(e,r,t,o,n)},e.setSpriteFrame=function(e,t){a._ins.setSpriteFrame(e,t)},e.setNodeGroupIndex=function(e,t){a._ins.setNodeGroupIndex(e,t)},e.setBtnClickSpr=function(e,t,o){a._ins.setBtnClickSpr(e,t,o)},e.setSpriteState=function(e,t){a._ins.setSpriteState(e,t)},e.setNodeParent=function(e,t){a._ins.setNodeParent(e,t)},e.random=function(e,t,o){return void 0===o&&(o=!0),s._ins.random(e,t,o)},e.chooseRandom=function(e){return s._ins.chooseRandom(e)},e.refractionY=function(e){return s._ins.refractionY(e)},e.refractionX=function(e){return s._ins.refractionX(e)},e.aginSortArr=function(e){s._ins.aginSortArr(e)},e.sortArrForObject=function(e,t,o){void 0===o&&(o=!1),s._ins.sortArrForObject(e,t,o)},e.getDiffNumRandom=function(e,t,o){return s._ins.getDiffNumRandom(e,t,o)},e.getAngleForPos=function(e,t,o){return void 0===o&&(o=!1),c._ins.getAngleForPos(this.getV2ForV3(e),this.getV2ForV3(t),o)},e.getDistance=function(e,t){return c._ins.getDistance(this.getV2ForV3(e),this.getV2ForV3(t))},e.getV2ForV3=function(e){return cc.v2(e.x,e.y)},e.getPosForAngleLen=function(e,t,o){return void 0===o&&(o=cc.v2(0,0)),c._ins.getPosForAngleLen(e,t,o)},e.getToNodePosForNode=function(e,t){return c._ins.getToNodePosForNode(e,t)},e.getToWorldPosAR=function(e){return c._ins.getToWorldPosAR(e)},e.getToNodePosForWorld=function(e,t){return c._ins.getToNodePosForWorld(e,t)},e.removeArrForValue=function(e,t){return e.splice(e.indexOf(t),1)},e.addArrNoValue=function(e,t){return e.indexOf(t)<0&&(e.push(t),!0)},e.addArrIndex=function(e,t,o){return e.splice(t,0,o)},e.insertStrForIndex=function(e,t,o){return e.slice(0,t)+o+e.slice(t)},e.prefixInteger=function(e,t){return void 0===t&&(t=2),(Array(t).join("0")+e).slice(-t)},e.getLanguageType=function(){var e="EN";return cc.sys.language==cc.sys.LANGUAGE_CHINESE?e=-1!=cc.sys.languageCode.toLowerCase().indexOf("zh-cn")||-1!=cc.sys.languageCode.toLowerCase().indexOf("zh_cn")?"CN":"CHT":cc.sys.language==cc.sys.LANGUAGE_KOREAN?e="KOR":cc.sys.language==cc.sys.LANGUAGE_JAPANESE?e="JP":"th-TH"==window.navigator.language&&(e="TH"),e},e.SpriteFrameDic=new Map,e.PrefabDic=new Map,e.AudioClipDic=new Map,e}();o.Tools=i;var a=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.newPrefab=function(e,t,o,n,a){void 0===a&&(a=0);var s=i.PrefabDic.get(e),c=null;return null!=s?(c=cc.instantiate(s),o&&o.addChild(c,a),n&&(c.position=cc.v3(n.x,n.y,0)),null!=t&&t(c)):r.LoadTools._ins.loadResPrefab(e,t,o,n,a),c},e.prototype.newSprite=function(e,t,o,n,a){void 0===a&&(a=0);var s=new cc.Node;return s.name=e,null!=i.SpriteFrameDic.get(e)?(s.addComponent(cc.Sprite).spriteFrame=i.SpriteFrameDic.get(e),o&&o.addChild(s,a),n&&(s.position=cc.v3(n.x,n.y,0)),null!=t&&t(s)):(s.addComponent(cc.Sprite),r.LoadTools._ins.loadResSpriteFrame(e,s,o,n,a,t)),s},e.prototype.setSpriteFrame=function(e,t){i.SpriteFrameDic.get(t)?e.getComponent(cc.Sprite).spriteFrame=i.SpriteFrameDic.get(t):r.LoadTools._ins.loadResAny(t,cc.SpriteFrame,function(t){e.getComponent(cc.Sprite).spriteFrame=t})},e.prototype.setNodeGroupIndex=function(e,t){e.groupIndex=t;for(var o=0;o<e.children.length;o++)e.children[o].groupIndex=t},e.prototype.setBtnClickSpr=function(e,t,o){i.SpriteFrameDic.get(t)?(e.getComponent(cc.Button).normalSprite=i.SpriteFrameDic.get(t),e.getComponent(cc.Button).hoverSprite=i.SpriteFrameDic.get(t),e.getComponent(cc.Button).pressedSprite=i.SpriteFrameDic.get(o)):(r.LoadTools._ins.loadResAny(t,cc.SpriteFrame,function(t){e.getComponent(cc.Button).normalSprite=t,e.getComponent(cc.Button).hoverSprite=t}),r.LoadTools._ins.loadResAny(o,cc.SpriteFrame,function(t){e.getComponent(cc.Button).pressedSprite=t}))},e.prototype.setSpriteState=function(e,t){var o=0==t?"builtin-2d-sprite":"builtin-2d-gray-sprite";cc.loader.loadRes("materials/"+o,cc.Material,function(t,o){t?cc.error(t):e.getComponent(cc.Sprite).setMaterial(0,o)})},e.prototype.setNodeParent=function(e,t){var o=c._ins.getToNodePosForNode(e,t);e.parent=t,e.position=cc.v3(o.x,o.y)},e._instance=new e,e}(),s=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.random=function(e,t,o){return void 0===o&&(o=!0),o?e+Math.floor(Math.random()*(t-e+1)):Math.random()*(t-e)+e},e.prototype.chooseRandom=function(e){for(var t=0,o=0;o<e.length;o++)t+=e[o];var n=this.random(0,t,!1);for(o=0;o<e.length;o++){if(n<e[o])return o;n-=e[o]}return e.length-1},e.prototype.refractionY=function(e){return Math.atan2(Math.sin(e),-Math.cos(e))},e.prototype.refractionX=function(e){return Math.atan2(-Math.sin(e),Math.cos(e))},e.prototype.aginSortArr=function(e){for(var t=0;t<e.length;t++){var o=i.random(0,e.length-1);if(o!=t){var n=e[t];e[t]=e[o],e[o]=n}}},e.prototype.sortArrForObject=function(e,t,o){void 0===o&&(o=!1),o?e.sort(function(e,o){return o[t]-e[t]}):e.sort(function(e,o){return e[t]-o[t]})},e.prototype.getDiffNumRandom=function(e,t,o){for(var n=[],r=e;r<=t;r++)n.push(r);var a=n.length-o;for(r=0;r<a;r++){var s=i.random(0,n.length-1);n.splice(s,1)}return n},e._instance=new e,e}(),c=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.getAngleForPos=function(e,t,o){void 0===o&&(o=!1);var n;return n=o?-Math.atan2(t.x-e.x,t.y-e.y):Math.atan2(t.y-e.y,t.x-e.x),cc.misc.radiansToDegrees(n)},e.prototype.getDistance=function(e,t){return e.sub(t).mag()},e.prototype.getPosForAngleLen=function(e,t,o){void 0===o&&(o=cc.v2(0,0));var n=cc.misc.degreesToRadians(e);return cc.v3(o.x+Math.cos(n)*t,o.y+Math.sin(n)*t)},e.prototype.getToNodePosForNode=function(e,t){var o=e.parent.convertToWorldSpaceAR(e.position),n=t.convertToNodeSpaceAR(o);return cc.v2(n.x,n.y)},e.prototype.getToWorldPosAR=function(e){return e.parent.convertToWorldSpaceAR(e.position)},e.prototype.getToNodePosForWorld=function(e,t){return t.convertToNodeSpaceAR(e)},e._instance=new e,e}();cc._RF.pop()},{"../manager/PlatformManager":"PlatformManager","./LoadTools":"LoadTools"}],UIManager:[function(e,t,o){"use strict";cc._RF.push(t,"2db57i1B6xAH6TGmydefCWN","UIManager");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.UIManager=void 0;var a=e("../common/Tools"),s=e("../common/weiSanTools"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.OpenUI=function(e,t){void 0===t&&(t=!1);for(var o,n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l[e]&&(o=l[e]),null==o)return s.weiSan.error("\u672a\u627e\u5230\u8be5UI\u7684\u914d\u7f6e\u4fe1\u606f:"+e),null;this.UIDic.has(e)?s.weiSan.warn("\u5df2\u7ecf\u6253\u5f00\u8fc7UI:"+e):(1==t&&this.removeAllUI(),this.CreateUI.apply(this,i([o],n)))},t.CloseUI=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(t=this.UIDic.get(e)){this.UIDic.delete(e);var r=t.getComponent(t.config.com);r&&r.closeUI&&r.closeUI.apply(r,o)}else s.weiSan.warn("\u5df2\u7ecf\u5173\u95ed\u8fc7UI:"+e)},t.GetUI=function(e){var t=this.UIDic.get(e);return null!=t?t:(s.weiSan.log("\u6ca1\u6709\u6253\u5f00UI:"+e),null)},t.GetUIForComponent=function(e){var t=this.UIDic.get(e);return null!=t?t.getComponent(t.config.com):(s.weiSan.warn("\u6ca1\u6709\u6253\u5f00UI:"+e),null)},t.CreateUI=function(e){for(var t=this,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(null==this.UIDic.get(e.name)){var r=cc.director.getScene().getChildByName("Canvas");a.Tools.newPrefab(e.resUrl,r,null,e.zIndex,function(n){n.config=e;var r=n.getComponent(e.com);r&&r.openUI&&(r.openUI.apply(r,o),r.uiName=e.name),t.UIDic.set(e.name,n)})}},t.removeAllUI=function(){for(var e in this.UIDic)this.CloseUI(e)},t.removeUIDic=function(){this.UIDic.clear()},t.prototype.onDestroy=function(){t.UIDic.delete(this.uiName)},t.UIDic=new Map,t}(cc.Component);o.UIManager=c;var l={OverUI:{name:"OverUI",resUrl:"OverUI",com:"OverUI",zIndex:99}};cc._RF.pop()},{"../common/Tools":"Tools","../common/weiSanTools":"weiSanTools"}],WordsModel:[function(e,t,o){"use strict";cc._RF.push(t,"2ece89cEWRIPr2lAofwJh4H","WordsModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.WordsModel=void 0;var n=e("../common/Tools"),r=e("../common/weiSanTools");o.WordsModel={gameName:{CN:"\u5927\u6218\u5c0f\u9ed1",CHT:"\u5927\u6230\u5c0f\u9ed1",EN:"Fighting Ghosts",KOR:"\ube14\ub7ad\ud06c",JP:"\u5927\u6226\u30af\u30ed",TH:"\u0e2a\u0e07\u0e04\u0e23\u0e32\u0e21\u0e40\u0e25\u0e47\u0e01\u0e2a\u0e35\u0e14\u0e33"},overScoreInfo_0:{CN:"\u53ea\u5f970\u5206\uff0c\u5168\u7403\u72ec\u4e00\u4e2a\uff01",CHT:"\u53ea\u5f970\u5206\uff0c\u5168\u7403\u7368\u4e00\u500b\uff01",EN:"Only 0, the only one in the world!",KOR:"0\uc810\ubc16\uc5d0 \uc548 \ub3fc, \uc804 \uc138\uacc4\uc5d0\uc11c \ud558\ub098\uc57c!",JP:"0\u70b9\u3057\u304b\u53d6\u308c\u307e\u305b\u3093\u3002\u4e16\u754c\u3067\u552f\u4e00\u3067\u3059",TH:"\u0e21\u0e35\u0e40\u0e1e\u0e35\u0e22\u0e07 <NU>0 \u0e08\u0e38\u0e14\u0e2b\u0e19\u0e36\u0e48\u0e07\u0e43\u0e19\u0e42\u0e25\u0e01"},overScoreInfo_1:{CN:"\u51fb\u8d25\u4e86\u5168\u7403",CHT:"\u64ca\u6557\u4e86\u5168\u7403",EN:"Handy: beat the world ",KOR:"\uaca9\ud30c",JP:"\u6253\u3061\u8ca0\u304b\u3059",TH:"\u0e17\u0e33\u0e43\u0e2b\u0e49\u0e1e\u0e48\u0e32\u0e22\u0e41\u0e1e\u0e49"},overScoreInfo_2:{CN:"\u7684\u73a9\u5bb6\uff01",CHT:"\u7684\u73a9\u5bb6\uff01",EN:" of the players!",KOR:"\uc720\uc800!",JP:"\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff01",TH:"\u0e1c\u0e39\u0e49\u0e40\u0e25\u0e48\u0e19\u0e02\u0e2d\u0e07"},overTitle_1:{CN:"\u6211\u771f\u662f\u592a\u5389\u5bb3\u4e86\uff0c\u6211\u5728",CHT:"\u6211\u771f\u662f\u592a\u53b2\u5bb3\u4e86\uff0c\u6211\u5728",EN:"I'm really great.  I'm in "},overTitle_2:{CN:"\u4e2d,",CHT:"\u4e2d,",EN:". "},kill_1:{CN:"\u72d9\u51fb ",CHT:"\u72d9\u64ca ",EN:"Kill ",KOR:"\uc800\uaca9\ud558\ub2e4 "},kill_2:{CN:" \u540d\u5c0f\u9ed1\u4eba",CHT:" \u540d\u5c0f\u9ed1\u4eba",EN:" Ghosts!",KOR:" \uc791\uc740 \ud751\uc778"},kill_3:{CN:"\u72d9\u51fb ",CHT:"\u64ca\u6bba ",EN:"Kill ",KOR:"\uc800\uaca9\ud558\ub2e4 "},kill_4:{CN:" \u5c0f\u9ed1\u4eba",CHT:" \u5c0f\u9ed1\u4eba",EN:" Ghosts",KOR:" \uc791\uc740 \ud751\uc778"},surplus_1:{CN:"\u5269\u4f59 ",CHT:"\u5269\u9918 ",EN:" ",KOR:"\ub0a8\uc740 \ud751\uc778 "},surplus_2:{CN:" \u5c0f\u9ed1\u4eba",CHT:" \u5c0f\u9ed1\u4eba",EN:" Ghosts Left",KOR:" \uba85"},getStrForLanguage:function(e,t){if(t=t||n.Tools.getLanguageType(),this[e])return this[e][t]?this[e][t]:this[e].EN;r.weiSan.log("\u6ca1\u6709\u7ffb\u8bd1:"+e)}},cc._RF.pop()},{"../common/Tools":"Tools","../common/weiSanTools":"weiSanTools"}],circleItem:[function(e,t,o){"use strict";cc._RF.push(t,"a4a0fC2BXRMT47BUnRh0R1B","circleItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/Tools"),s=e("../../ctrl/GameCtrl"),c=e("../../ctrl/MapCtrl"),l=e("../../model/OtherModel"),p=e("../Player/Enemy"),d=e("../Player/Player"),u=cc._decorator,h=u.ccclass,m=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.circleMask=null,t.bgSpr=null,t.corePos=cc.v2(0,0),t.circleCollider=null,t.circleLen=800,t.scaleSpeed=30,t.isPause=!1,t}return r(t,e),t.prototype.start=function(){var e=this;this.circleCollider=this.node.getComponent(cc.CircleCollider),this.circleCollider.enabled=!1,this.scheduleOnce(function(){e.initRandomPos(),e.drawCircle(e.circleLen)},0)},t.prototype.initRandomPos=function(){var e=c.MapCtrl._ins.getRandomFloor(1,5,5);this.corePos=e.position;var t=c.MapCtrl._ins.mapWidth/2*(this.corePos.x>0?-1:1),o=c.MapCtrl._ins.mapHeight/2*(this.corePos.y>0?-1:1);this.circleLen=a.Tools.getDistance(cc.v3(t,o),this.corePos),this.circleCollider.offset=this.corePos,this.circleCollider.enabled=!0},t.prototype.update=function(e){this.isPause||s.GameCtrl._ins.gameState!=s.GameState.Start&&s.GameCtrl._ins.gameState!=s.GameState.Over||(this.circleLen<=2e3&&(this.circleLen=2e3),this.drawCircle(this.circleLen),this.circleCollider.radius=this.circleLen,this.circleLen-=this.scaleSpeed*e)},t.prototype.drawCircle=function(e){void 0===e&&(e=50);var t=this.circleMask._graphics;t.clear(),t.ellipse(this.corePos.x,this.corePos.y,e,e),t.fillColor=cc.color(0,0,0,255),t.lineWidth=e,t.fill()},t.prototype.onCollisionEnter=function(e){e.tag==l.interTag.playerBody?e.node.getComponent(d.default).outCircle():e.tag==l.interTag.enemyBody&&e.node.getComponent(p.default).outCircle()},t.prototype.onCollisionExit=function(e){e.tag==l.interTag.playerBody?e.node.getComponent(d.default).inCircle():e.tag==l.interTag.enemyBody&&e.node.getComponent(p.default).inCircle()},i([m(cc.Mask)],t.prototype,"circleMask",void 0),i([m(cc.Node)],t.prototype,"bgSpr",void 0),i([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../common/Tools":"Tools","../../ctrl/GameCtrl":"GameCtrl","../../ctrl/MapCtrl":"MapCtrl","../../model/OtherModel":"OtherModel","../Player/Enemy":"Enemy","../Player/Player":"Player"}],fireAni:[function(e,t,o){"use strict";cc._RF.push(t,"d95d9nR4aZO24UB3ZaszZbB","fireAni");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starSprs=[],t.fireSprs_1=[],t.fireSprs_2=[],t.pointSpr=null,t.tailSpr=null,t.fireAudio=null,t.effectArr=[],t.repeatNum=-1,t}return r(t,e),t.prototype.start=function(){var e=this;this.effectArr.push(this.fireSprs_1),this.effectArr.push(this.fireSprs_2),-1==this.repeatNum?cc.tween(this.node).call(function(){e.fireWorks()}).delay(1.5).union().repeatForever().start():cc.tween(this.node).call(function(){e.fireWorks()}).delay(1.5).union().repeat(this.repeatNum).start()},t.prototype.fireWorks=function(){for(var e=this,t=this.random(6,8),o=function(){var t=n.random(1,1.5,!1),o=Math.random()<=.5?1:-1,r=cc.v3(o*n.random(100,300),n.node.y-n.node.height/2-100),i=n.newCircle(r,t,n.node),a=cc.v3(r.x,n.random(0,350)),s=n.random(.3,1,!1);cc.tween(i).delay(s).to(.5,{position:a}).to(.2,{opacity:0}).call(function(o){e.effectAni(a,t),o.destroy()}).union().start()},n=this,r=0;r<t;r++)o()},t.prototype.effectAni=function(e,t){for(var o=this.random(0,this.effectArr.length-1),n=0;n<this.effectArr[o].length;n++){var r=.1*n;this.scheduleOnce(function(){cc.audioEngine.play(this.fireAudio,!1,.5)},r);for(var i=0;i<9;i++){var a=this.newSpr(this.effectArr[o][n],this.node);a.scale=t;var s=40*i;a.angle=1==n?20+s:s,a.position=e;var c=cc.v2(0,10);c.rotateSelf(s*Math.PI/180);var l=c.normalize();cc.tween(a).by(.3,{position:cc.v3(l.mul(80*(n+1)*t))}).to(.1,{opacity:0}).call(function(e){e.destroy()}).start()}}for(n=0;n<2;n++){var p=this.newSpr(this.starSprs[this.random(0,this.starSprs.length-1)],this.node);p.position=cc.v3(this.random(-300,300),this.random(100,500)),p.scale=this.random(.7,1.5,!1),p.opacity=0;var d=this.random(.2,.4,!1);cc.tween(p).to(d,{opacity:255}).to(d,{opacity:0}).call(function(e){e.destroy()}).start()}},t.prototype.newCircle=function(e,t,o){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.pointSpr,n.groupIndex=this.node.groupIndex,n.position=e,n.scale=t,o.addChild(n);var r=new cc.Node;return r.groupIndex=this.node.groupIndex,n.addChild(r),r.y=15,r.addComponent(cc.MotionStreak).texture=this.tailSpr.getTexture(),r.getComponent(cc.MotionStreak).fadeTime=.15,r.getComponent(cc.MotionStreak).stroke=n.scale*n.width-5,n},t.prototype.newSpr=function(e,t){var o=new cc.Node;return o.addComponent(cc.Sprite).spriteFrame=e,o.groupIndex=this.node.groupIndex,t.addChild(o),o},t.prototype.random=function(e,t,o){return void 0===o&&(o=!0),o?e+Math.floor(Math.random()*(t-e+1)):Math.random()*(t-e)+e},i([c([cc.SpriteFrame])],t.prototype,"starSprs",void 0),i([c([cc.SpriteFrame])],t.prototype,"fireSprs_1",void 0),i([c([cc.SpriteFrame])],t.prototype,"fireSprs_2",void 0),i([c(cc.SpriteFrame)],t.prototype,"pointSpr",void 0),i([c(cc.SpriteFrame)],t.prototype,"tailSpr",void 0),i([c(cc.AudioClip)],t.prototype,"fireAudio",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],floorItem:[function(e,t,o){"use strict";cc._RF.push(t,"bc491aNDfdMMb6qds7kfm1C","floorItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/AudioTools"),s=e("../common/Tools"),c=e("../ctrl/GameCtrl"),l=e("../ctrl/MapCtrl"),p=e("../model/GameModel"),d=e("../model/OtherModel"),u=cc._decorator,h=u.ccclass,m=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waterSpr=null,t.soilSpr=null,t.floorSpr=null,t.obsNode=null,t.obsType=0,t.obsHp=5,t.popNode=null,t.mapX=0,t.mapY=0,t}return r(t,e),t.prototype.initFloor=function(e,t){this.mapX=e,this.mapY=t,this.node.zIndex=1,this.initSoil()},t.prototype.initSoil=function(){if(!(this.mapX<=2||this.mapX>=l.MapCtrl._ins.maxMapX-1||this.mapY<=2||this.mapY>=l.MapCtrl._ins.maxMapY-1)&&Math.random()<=.5){s.Tools.setNodeParent(this.soilSpr,this.node.parent),this.soilSpr.zIndex=0,this.soilSpr.active=!0,this.soilSpr.opacity=s.Tools.random(80,130);var e=s.Tools.random(1,2);s.Tools.setSpriteFrame(this.soilSpr,"ground_"+e),this.soilSpr.scale=1==e?.5*Math.random()+1:.8*Math.random()+1,this.soilSpr.angle=s.Tools.random(0,360)}},t.prototype.showAni=function(e){void 0===e&&(e=0),this.node.opacity=0,cc.tween(this.node).delay(e).to(.2,{opacity:255}).start()},t.prototype.addObs=function(e,t,o){this.obsType=e,e==d.enumObsType.box?this.obsNode=this.newBox():e==d.enumObsType.tree?(this.obsNode=this.newBox(),s.Tools.setSpriteFrame(this.obsNode,"tree_"+s.Tools.random(1,3))):e==d.enumObsType.grass?(this.obsNode=this.newBox(),this.obsNode.getComponent(cc.PhysicsBoxCollider).destroy(),this.obsNode.getComponent(cc.RigidBody).destroy(),this.obsNode.getComponent(cc.BoxCollider).destroy(),s.Tools.setNodeParent(this.obsNode,t),this.obsNode.scale=1.1,s.Tools.setSpriteFrame(this.obsNode,"grass_"+o)):e==d.enumObsType.obs?(this.obsNode=this.newBox(),s.Tools.setSpriteFrame(this.obsNode,"obs_"+s.Tools.random(1,2))):e==d.enumObsType.water&&(this.floorSpr.destroy(),this.soilSpr.destroy(),this.waterSpr.destroy()),this.obsHp=p.GameModel._ins.obsHpArr[this.obsType-1]},t.prototype.unAttackObs=function(e,t){var o=s.Tools.random(1,2);if(c.GameCtrl._ins.attackObsPar(this.node,this,o),this.obsHp-=e,(this.obsType==d.enumObsType.box||this.obsType==d.enumObsType.grass||this.obsType==d.enumObsType.tree)&&this.obsHp<=0&&(c.GameCtrl._ins.attackObsPar(this.node,this,30),t==d.interTag.playerBullet&&(this.obsType==d.enumObsType.box?a.AudioTools._ins.playAudio("bomb_box",.3):a.AudioTools._ins.playAudio("bomb_Tree",1.5)),this.obsNode.destroy(),this.obsType=0,this.obsNode=null,p.GameModel._ins.mainGame.aStar.setMapObs(this.mapX,this.mapY,0),Math.random()<=.3)){var n=p.GameModel._ins.mainGame.newPop();n.position=this.node.position,this.popNode=n,n.getComponent("popItem").floorItem=this,n.scale=0,cc.tween(n).to(.35,{scale:1}).start(),p.GameModel._ins.mainGame.popNodeArr.push(n)}},t.prototype.newBox=function(){return s.Tools.newPrefab("boxPre",this.node)},i([m(cc.Node)],t.prototype,"waterSpr",void 0),i([m(cc.Node)],t.prototype,"soilSpr",void 0),i([m(cc.Node)],t.prototype,"floorSpr",void 0),i([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../common/AudioTools":"AudioTools","../common/Tools":"Tools","../ctrl/GameCtrl":"GameCtrl","../ctrl/MapCtrl":"MapCtrl","../model/GameModel":"GameModel","../model/OtherModel":"OtherModel"}],mTools:[function(e,t,o){"use strict";cc._RF.push(t,"bc7b6XHEL1Mk5Kp3oxzNW2M","mTools"),Object.defineProperty(o,"__esModule",{value:!0}),o.mTools=void 0;var n=function(){function e(){}return Object.defineProperty(e,"_ins",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.drawRound=function(e,t,o,n,r,i){void 0===i&&(i=!1),i&&e.clear(),r||(r=cc.Color.WHITE),e.circle(t.x,t.y,o),e.fillColor=r,e.strokeColor=r,e.lineWidth=n,0==n?e.fill():e.stroke()},e.prototype.isOutTwoArr=function(e,t,o){return e<0||t<0||e>o.length-1||t>o[0].length-1},e._instance=new e,e}();o.mTools=n,cc._RF.pop()},{}],popItem:[function(e,t,o){"use strict";cc._RF.push(t,"d798bx0KEZMV7eo5GXMKZTc","popItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/ActionTools"),s=e("../common/Tools"),c=e("../ctrl/GameCtrl"),l=e("../model/GameModel"),p=e("./Player/Player"),d=cc._decorator,u=d.ccclass,h=d.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popBg=null,t.popSpr=null,t.popType=1,t.popID=1,t.quality=1,t.floorItem=null,t}return r(t,e),t.prototype.initPop=function(e,t){void 0===e&&(e=1),void 0===t&&(t=1),1==e?s.Tools.setSpriteFrame(this.popSpr,"pop_"+t):2==e&&(s.Tools.setSpriteFrame(this.popSpr,"firearm_"+t),this.popSpr.scale=.8,this.initFirePop(t),this.brihtAni(this.popBg),this.fireParAni()),this.popType=e,this.popID=t,this.floatAni()},t.prototype.initFirePop=function(e){var t=c.GameCtrl._ins.getArmConfigForID(e).quality;s.Tools.setSpriteFrame(this.popBg,"fireBg_"+t),this.popBg.scale=5==e?.8:.7+.1*t,this.quality=t},t.prototype.usePop=function(e){if(1==this.popType)1==this.popID?e.getComponent(p.default).updateHpNum(20):2!=this.popID&&3!=this.popID||(e.getComponent(p.default).addAcNum(this.popID),this.useArmPar(e));else if(2==this.popType){if(e.getComponent(p.default).armID==this.popID)return!1;this.useArmPar(e),e.getComponent(p.default).switchArm(this.popID)}return this.removeAni(),!0},t.prototype.removeAni=function(){var e=this;cc.Tween.stopAllByTarget(this.popSpr),this.node.getComponent(cc.CircleCollider).destroy(),s.Tools.removeArrForValue(l.GameModel._ins.mainGame.popNodeArr,this.node),this.floorItem.popNode=null,this.popSpr.destroy(),cc.tween(this.node).to(.35,{scale:3}).start(),cc.tween(this.node).delay(.15).to(.2,{opacity:0}).call(function(){e.node.destroy()}).start()},t.prototype.useArmPar=function(e){for(var t=0;t<15;t++){var o=s.Tools.newSprite("smoke_"+s.Tools.random(1,3),e,cc.v2(0,0),10);o.x+=s.Tools.random(-e.width/2,e.width/2),o.y+=s.Tools.random(-e.height/2,e.height/2),o.scale=1+Math.random(),o.opacity=s.Tools.random(150,255),o.angle=s.Tools.random(0,360),o.groupIndex=e.groupIndex;var n=s.Tools.random(150,250),r=a.ActionTools._ins.moveDegressAni(o,null,n,300,!1,!0);o.runAction(cc.rotateBy(.5,s.Tools.random(-360,360)).repeatForever()),o.runAction(cc.sequence(cc.delayTime(r+.1),cc.callFunc(function(e){e.destroy()},this)))}for(t=0;t<10;t++){var i=s.Tools.newSprite("winStar",e,cc.v2(0,0),10);i.x+=s.Tools.random(.8*-e.height,.8*e.height),i.y+=s.Tools.random(.8*-e.height,.8*e.height),i.scale=0,i.opacity=s.Tools.random(150,255),i.angle=s.Tools.random(0,360),i.groupIndex=e.groupIndex;var c=.8+Math.random();i.runAction(cc.rotateBy(.5,s.Tools.random(-360,360)).repeatForever()),i.runAction(cc.sequence(cc.scaleTo(.1,c).easing(cc.easeBackOut()),cc.delayTime(.3),cc.scaleTo(.1,0).easing(cc.easeBackIn()),cc.callFunc(function(e){e.destroy()},this)))}},t.prototype.floatAni=function(){cc.tween(this.popSpr).by(.5,{position:cc.v3(0,20)},{easing:"sineInOut"}).by(.5,{position:cc.v3(0,-20)},{easing:"sineInOut"}).union().repeatForever().start()},t.prototype.brihtAni=function(e){cc.tween(e).by(1,{opacity:-100},{easing:cc.easing.sineInOut}).by(1,{opacity:100},{easing:cc.easing.sineInOut}).union().repeatForever().start()},t.prototype.fireParAni=function(){var e=this;cc.tween(this.node).delay(.5).call(function(){for(var t=function(){var t=cc.v2(s.Tools.random(-e.popBg.width/2,e.popBg.width/2)*e.popBg.scale+e.node.x,s.Tools.random(.5*-e.popBg.height,0)*e.popBg.scale+e.node.y),o=s.Tools.newSprite("popFirePar_"+e.quality,e.node.parent,t,e.node.zIndex+1);o.scale=0,o.opacity=180,o.angle=s.Tools.random(0,360),o.groupIndex=e.node.groupIndex;var n=.5+.5*Math.random(),r=.5*Math.random();cc.tween(o).delay(r).call(function(e){e.position=cc.v3(t.x,t.y)}).to(.2,{scale:n},{easing:"backOut"}).delay(.8-.2-.2).to(.2,{opacity:0}).start(),cc.tween(o).delay(r).by(.8,{position:cc.v3(0,200)}).call(function(e){e.destroy()}).start()},o=0;o<10;o++)t()}).union().repeatForever().start()},i([h(cc.Node)],t.prototype,"popBg",void 0),i([h(cc.Node)],t.prototype,"popSpr",void 0),i([u],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../common/ActionTools":"ActionTools","../common/Tools":"Tools","../ctrl/GameCtrl":"GameCtrl","../model/GameModel":"GameModel","./Player/Player":"Player"}],smallMapItem:[function(e,t,o){"use strict";cc._RF.push(t,"6b94aQWR1ZF6qgt/ckBYT1N","smallMapItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../common/mTools"),s=e("../ctrl/GameCtrl"),c=e("../ctrl/MapCtrl"),l=e("../manager/EventManager"),p=e("../model/GameModel"),d=e("./mainGame/circleItem"),u=e("./Player/Player"),h=cc._decorator,m=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfNode=null,t.otherNode=null,t.circleMask=null,t.circleNode=null,t.scaleNum=.1,t.rangeWidth=3e3,t.rangeHeight=3e3,t.enemyArr=null,t.playerNode=null,t.enmeyRangeMap=new Map,t}return r(t,e),t.prototype.onLoad=function(){this.enemyArr=p.GameModel._ins.mainGame.enemyArr,this.playerNode=p.GameModel._ins.mainGame.playerTs.node,this.otherNode.active=!1,this.selfNode.zIndex=1,this.addInitListener()},t.prototype.start=function(){var e=this;this.scheduleOnce(function(){e.rangeWidth=c.MapCtrl._ins.mapWidth,e.rangeHeight=c.MapCtrl._ins.mapHeight,e.scaleNum=e.node.width/e.rangeWidth},0)},t.prototype.update=function(){s.GameCtrl._ins.gameState==s.GameState.Start&&(this.updateDisplay(),this.selfNode.angle=this.playerNode.getComponent(u.default).tempAngle,this.selfNode.position=cc.v3(this.playerNode.x*this.scaleNum,this.playerNode.y*this.scaleNum),this.updateCircleMask())},t.prototype.updateDisplay=function(){for(var e=0;e<this.enemyArr.length;e++){var t=this.enemyArr[e];Math.abs(t.node.x)<=this.rangeWidth&&Math.abs(t.node.y)<=this.rangeHeight?this.updateEnemy(t):this.enmeyRangeMap.get(t)&&this.removeEnemy(t)}},t.prototype.updateEnemy=function(e){var t=null;this.enmeyRangeMap.get(e)?t=this.enmeyRangeMap.get(e):(t=this.newArrow(),this.enmeyRangeMap.set(e,t)),t.x=e.node.x*this.scaleNum,t.y=e.node.y*this.scaleNum,t.angle=e.tempAngle},t.prototype.updateCircleMask=function(){var e=this.circleNode.getComponent(d.default),t=cc.v2(e.corePos.x*this.scaleNum,e.corePos.y*this.scaleNum),o=this.circleMask._graphics;o.clear(),a.mTools._ins.drawRound(o,t,e.circleLen*this.scaleNum,0,cc.color(0,0,0,255))},t.prototype.newArrow=function(){var e=cc.instantiate(this.otherNode);return e.scale=.7,e.group=this.node.group,e.active=!0,this.node.addChild(e),e},t.prototype.removeEnemy=function(e){this.enmeyRangeMap.get(e)&&this.enmeyRangeMap.get(e).destroy(),this.enmeyRangeMap.delete(e)},t.prototype.addInitListener=function(){l.EventManager.addListener(l.EventData.REMOVE_ENEMY,this.removeEnemy.bind(this),this.node)},t.prototype.onDestroy=function(){l.EventManager.removeListenerForTarget(this.node)},i([f(cc.Node)],t.prototype,"selfNode",void 0),i([f(cc.Node)],t.prototype,"otherNode",void 0),i([f(cc.Mask)],t.prototype,"circleMask",void 0),i([f(cc.Node)],t.prototype,"circleNode",void 0),i([m],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../common/mTools":"mTools","../ctrl/GameCtrl":"GameCtrl","../ctrl/MapCtrl":"MapCtrl","../manager/EventManager":"EventManager","../model/GameModel":"GameModel","./Player/Player":"Player","./mainGame/circleItem":"circleItem"}],weiSanTools:[function(e,t,o){"use strict";cc._RF.push(t,"ff39aoXMlBNuoJpIycuGqrL","weiSanTools");var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.weiSan=void 0;var r=function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isLog&&console.log.apply(console,n([this.logName],e))},e.logTrace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isLog&&console.trace.apply(console,n([this.logName],e))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isLog&&console.error.apply(console,n([this.logName],e))},e.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isLog&&console.warn.apply(console,n([this.logName],e))},e.initLog=function(){console.log(this.logInfo)},e.isLog=!0,e.logName="\u5fae\u4f1e\u6e38\u620fLog:",e.logInfo="\u672c\u6e38\u620f\u5305\u542b\u7684\u6240\u6709\u5185\u5bb9\uff08\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a\u4ee3\u7801\u3001\u56fe\u7247\u3001\u89c6\u50cf\u53ca\u58f0\u97f3\u5185\u5bb9\u3001\u540d\u79f0\uff09\u7684\u6240\u6709\u6743\u5f52\u5317\u4eac\u7c73\u515c\u79d1\u6280\u6709\u9650\u516c\u53f8\u6240\u6709\u3002\u4efb\u4f55\u5355\u4f4d\u6216\u4e2a\u4eba\u5c06\u672c\u6e38\u620f\u63d0\u4f9b\u7684\u5185\u5bb9\u4e0e\u670d\u52a1\u7528\u4e8e\u5546\u4e1a\u3001\u76c8\u5229\u3001\u5e7f\u544a\u6027\u7b49\u76ee\u7684\u65f6\uff0c\u9700\u5f81\u5f97\u5317\u4eac\u7c73\u515c\u79d1\u6280\u6709\u9650\u516c\u53f8\u76f8\u5173\u6743\u5229\u4eba\u7684\u4e66\u9762\u8bb8\u53ef\uff1b\u5c06\u672c\u7f51\u7ad9\u63d0\u4f9b\u7684\u5185\u5bb9\u4e0e\u670d\u52a1\u7528\u4e8e\u975e\u5546\u4e1a\u7528\u9014\u65f6\uff0c\u5e94\u9075\u5b88\u8457\u4f5c\u6743\u6cd5\u4ee5\u53ca\u5176\u4ed6\u76f8\u5173\u6cd5\u5f8b\u7684\u89c4\u5b9a\uff0c\u4e0d\u5f97\u4fb5\u72af\u6e38\u620f\u6240\u6709\u8005\u53ca\u76f8\u5173\u6743\u5229\u4eba\u7684\u6743\u76ca\u3002",e}();o.weiSan=r,cc._RF.pop()},{}]},{},["AdManager","AdManager_H5","ActionTools","AudioTools","LoadTools","Tools","mTools","weiSanTools","AStar","GameCtrl","MapCtrl","InitGame","MainGame","CameraItem","ArmItem","Boss","Bullet","Enemy","Player","ResArr","fireAni","floorItem","circleItem","popItem","smallMapItem","EventManager","NetworkManager","PlatformManager","PoolManager","UIManager","GameModel","OtherModel","WordsModel","OverUI"]);